"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/character-infer/route";
exports.ids = ["app/api/character-infer/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcharacter-infer%2Froute&page=%2Fapi%2Fcharacter-infer%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcharacter-infer%2Froute.ts&appDir=%2Fhome%2Fjr%2FProjetos%2FMestrAi%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fjr%2FProjetos%2FMestrAi&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcharacter-infer%2Froute&page=%2Fapi%2Fcharacter-infer%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcharacter-infer%2Froute.ts&appDir=%2Fhome%2Fjr%2FProjetos%2FMestrAi%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fjr%2FProjetos%2FMestrAi&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_jr_Projetos_MestrAi_app_api_character_infer_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/character-infer/route.ts */ \"(rsc)/./app/api/character-infer/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/character-infer/route\",\n        pathname: \"/api/character-infer\",\n        filename: \"route\",\n        bundlePath: \"app/api/character-infer/route\"\n    },\n    resolvedPagePath: \"/home/jr/Projetos/MestrAi/app/api/character-infer/route.ts\",\n    nextConfigOutput,\n    userland: _home_jr_Projetos_MestrAi_app_api_character_infer_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/character-infer/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGFyYWN0ZXItaW5mZXIlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmNoYXJhY3Rlci1pbmZlciUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmNoYXJhY3Rlci1pbmZlciUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGanIlMkZQcm9qZXRvcyUyRk1lc3RyQWklMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmhvbWUlMkZqciUyRlByb2pldG9zJTJGTWVzdHJBaSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDVTtBQUN2RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RyYWktLS12aXJ0dWFsLXRhYmxldG9wLz81ZjQyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9ob21lL2pyL1Byb2pldG9zL01lc3RyQWkvYXBwL2FwaS9jaGFyYWN0ZXItaW5mZXIvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NoYXJhY3Rlci1pbmZlci9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NoYXJhY3Rlci1pbmZlclwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY2hhcmFjdGVyLWluZmVyL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2hvbWUvanIvUHJvamV0b3MvTWVzdHJBaS9hcHAvYXBpL2NoYXJhY3Rlci1pbmZlci9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2hhcmFjdGVyLWluZmVyL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcharacter-infer%2Froute&page=%2Fapi%2Fcharacter-infer%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcharacter-infer%2Froute.ts&appDir=%2Fhome%2Fjr%2FProjetos%2FMestrAi%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fjr%2FProjetos%2FMestrAi&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/character-infer/route.ts":
/*!******************************************!*\
  !*** ./app/api/character-infer/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var groq_sdk__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! groq-sdk */ \"(rsc)/./node_modules/groq-sdk/index.mjs\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var _lib_ai_keyPool__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/ai/keyPool */ \"(rsc)/./lib/ai/keyPool.ts\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../constants */ \"(rsc)/./constants.ts\");\n/* harmony import */ var _lib_ai_rateLimit__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../lib/ai/rateLimit */ \"(rsc)/./lib/ai/rateLimit.ts\");\n/* harmony import */ var _lib_ai_modelPool__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../lib/ai/modelPool */ \"(rsc)/./lib/ai/modelPool.ts\");\n\n\n\n\n\n\n\nconst bodySchema = zod__WEBPACK_IMPORTED_MODULE_5__.object({\n    systemName: zod__WEBPACK_IMPORTED_MODULE_5__.string(),\n    name: zod__WEBPACK_IMPORTED_MODULE_5__.string(),\n    appearance: zod__WEBPACK_IMPORTED_MODULE_5__.string(),\n    backstory: zod__WEBPACK_IMPORTED_MODULE_5__.string(),\n    profession: zod__WEBPACK_IMPORTED_MODULE_5__.string().optional()\n});\nconst characterSchema = zod__WEBPACK_IMPORTED_MODULE_5__.object({\n    class_or_role: zod__WEBPACK_IMPORTED_MODULE_5__.string(),\n    profession: zod__WEBPACK_IMPORTED_MODULE_5__.string().optional(),\n    attributes: zod__WEBPACK_IMPORTED_MODULE_5__.record(zod__WEBPACK_IMPORTED_MODULE_5__.number()),\n    skills: zod__WEBPACK_IMPORTED_MODULE_5__.union([\n        zod__WEBPACK_IMPORTED_MODULE_5__.array(zod__WEBPACK_IMPORTED_MODULE_5__.string()),\n        zod__WEBPACK_IMPORTED_MODULE_5__.string(),\n        zod__WEBPACK_IMPORTED_MODULE_5__.record(zod__WEBPACK_IMPORTED_MODULE_5__.any())\n    ]),\n    hp: zod__WEBPACK_IMPORTED_MODULE_5__.union([\n        zod__WEBPACK_IMPORTED_MODULE_5__.number(),\n        zod__WEBPACK_IMPORTED_MODULE_5__.string()\n    ]),\n    inventory: zod__WEBPACK_IMPORTED_MODULE_5__.union([\n        zod__WEBPACK_IMPORTED_MODULE_5__.array(zod__WEBPACK_IMPORTED_MODULE_5__.string()),\n        zod__WEBPACK_IMPORTED_MODULE_5__.string()\n    ]),\n    notes: zod__WEBPACK_IMPORTED_MODULE_5__.string().optional(),\n    // System-specific optional fields\n    sanity: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional(),\n    luck: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional(),\n    humanity: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional(),\n    blood_pool: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional(),\n    emp: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional(),\n    reputation: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional(),\n    mana: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional(),\n    stamina: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional(),\n    focus: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional(),\n    alignment: zod__WEBPACK_IMPORTED_MODULE_5__.string().optional(),\n    force_sensitive: zod__WEBPACK_IMPORTED_MODULE_5__.boolean().optional(),\n    force_rating: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional(),\n    grit: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional(),\n    corruption: zod__WEBPACK_IMPORTED_MODULE_5__.number().optional()\n});\nasync function POST(req) {\n    try {\n        const userKey = req.headers.get(\"x-custom-api-key\") || undefined;\n        const ip = (req.headers.get(\"x-forwarded-for\") || \"unknown\").split(\",\")[0].trim();\n        const rateKey = `infer:${ip}`;\n        if (await (0,_lib_ai_rateLimit__WEBPACK_IMPORTED_MODULE_3__.isRateLimited)(rateKey)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Rate limit exceeded\"\n            }, {\n                status: 429\n            });\n        }\n        const json = await req.json();\n        const parsed = bodySchema.safeParse(json);\n        if (!parsed.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid payload\"\n            }, {\n                status: 400\n            });\n        }\n        const { systemName, name, appearance, backstory, profession } = parsed.data;\n        const normalizedSystem = (0,_constants__WEBPACK_IMPORTED_MODULE_2__.normalizeSystemName)(systemName);\n        const rules = _constants__WEBPACK_IMPORTED_MODULE_2__.RPG_SYSTEMS[normalizedSystem] || _constants__WEBPACK_IMPORTED_MODULE_2__.RPG_SYSTEMS[\"Narrativo\"];\n        const skillsReference = _constants__WEBPACK_IMPORTED_MODULE_2__.SKILLS_BY_SYSTEM[normalizedSystem] || [];\n        const classOptions = _constants__WEBPACK_IMPORTED_MODULE_2__.CLASSES_BY_SYSTEM[normalizedSystem] || [];\n        let apiKey;\n        try {\n            apiKey = (0,_lib_ai_keyPool__WEBPACK_IMPORTED_MODULE_1__.pickApiKey)(userKey);\n        } catch  {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing API key\"\n            }, {\n                status: 401\n            });\n        }\n        const ai = new groq_sdk__WEBPACK_IMPORTED_MODULE_6__[\"default\"]({\n            apiKey\n        });\n        const systemHint = (()=>{\n            switch(normalizedSystem){\n                case \"D&D 5e\":\n                    return \"Use atributos em portugu\\xeas: for\\xe7a, destreza, constitui\\xe7\\xe3o, intelig\\xeancia, sabedoria, carisma. Valores 8-18. Inclua class_or_role e hp coerentes com o backstory.\";\n                case \"Ordem Paranormal\":\n                    return \"Use atributos em portugu\\xeas: for\\xe7a, agilidade, intelecto, presen\\xe7a, vigor. Valores 1-5 (padr\\xe3o), coerentes com o backstory. Inclua class_or_role e hp coerentes.\";\n                case \"Call of Cthulhu\":\n                    return \"Use atributos em portugu\\xeas: for\\xe7a, constitui\\xe7\\xe3o, destreza, intelig\\xeancia, poder, apar\\xeancia, educa\\xe7\\xe3o, tamanho. Valores 20-90. Inclua sanity e luck como n\\xfameros (0-99).\";\n                default:\n                    return \"Inclua apenas campos relevantes e coerentes com o backstory.\";\n            }\n        })();\n        const promptBase = `Sistema: ${normalizedSystem}. Regras resumidas: ${rules}\n\nCrie uma ficha JSON para o personagem usando os dados:\n Nome: ${name}\n Aparência: ${appearance}\n Backstory: ${backstory}\n Profissão/Ocupação (opcional): ${profession || \"n\\xe3o informada\"}\n\n${systemHint}\n\nLista de perícias permitidas (use apenas essas como referência):\n${skillsReference.map((s)=>`- ${s}`).join(\"\\n\")}\n\nClasses/roles permitidas (escolha UMA):\n${classOptions.map((c)=>`- ${c}`).join(\"\\n\")}\n\n  REGRAS CRÍTICAS:\n  - SEMPRE preencha: class_or_role, attributes, skills, hp, inventory.\n  - As perícias DEVEM ser inferidas a partir do backstory (profissão, passado, traumas, treinamento, experiências).\n  - Classe/role, HP, atributos e inventário também DEVEM ser inferidos a partir do backstory.\n  - Respeite estritamente as classes/roles permitidas para o sistema.\n  - Se o texto estiver genérico, INFERIR valores plausíveis com base no gênero e sistema.\n  - Se o backstory for raso, use total criatividade para preencher tudo com coerência.\n  - Nunca deixe atributos vazios; se faltar, preencha com valores padrão coerentes.\n  - Responda APENAS com um JSON válido (sem markdown, sem explicações).\n\nResponda APENAS com um JSON válido e conciso, sem Markdown.`;\n        const warnings = [];\n        const generate = async (extra)=>{\n            const prompt = `${promptBase}\\n\\n${extra}`.trim();\n            return (0,_lib_ai_modelPool__WEBPACK_IMPORTED_MODULE_4__.withModelFallback)((model)=>ai.chat.completions.create({\n                    model,\n                    messages: [\n                        {\n                            role: \"user\",\n                            content: prompt\n                        }\n                    ],\n                    temperature: 0.6\n                }), {\n                key: `infer:${systemName}`\n            });\n        };\n        const attempts = [\n            \"Gere valores completos e coerentes.\",\n            \"Se algo estiver faltando, complete com valores padr\\xe3o do sistema.\",\n            \"Reenvie um JSON v\\xe1lido com todos os campos obrigat\\xf3rios preenchidos.\"\n        ];\n        let parsedJson = null;\n        let parsedObj = null;\n        for (const extra of attempts){\n            const result = await generate(extra);\n            const raw = result.choices?.[0]?.message?.content || \"\";\n            const jsonMatch = raw.match(/\\{[\\s\\S]*\\}/);\n            if (!jsonMatch) continue;\n            try {\n                parsedJson = JSON.parse(jsonMatch[0]);\n            } catch (e) {\n                continue;\n            }\n            const candidate = characterSchema.safeParse(parsedJson);\n            if (candidate.success) {\n                parsedObj = candidate;\n                break;\n            }\n        }\n        if (!parsedObj?.success) {\n            warnings.push(\"Ficha incompleta. N\\xe3o foi poss\\xedvel concluir.\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                character: parsedJson || {},\n                warnings\n            });\n        }\n        const obj = parsedObj.data;\n        const normalizeString = (value)=>{\n            if (typeof value === \"string\") return value.trim();\n            if (value === null || value === undefined) return \"\";\n            return String(value).trim();\n        };\n        const coerceNumber = (value)=>{\n            if (typeof value === \"number\" && Number.isFinite(value)) return value;\n            if (typeof value === \"string\") {\n                const parsed = Number(value.replace(\",\", \".\"));\n                return Number.isFinite(parsed) ? parsed : null;\n            }\n            return null;\n        };\n        const clamp = (value, min, max)=>Math.min(max, Math.max(min, value));\n        const randomInRange = (min, max, step = 1)=>{\n            const steps = Math.floor((max - min) / step) + 1;\n            return min + step * Math.floor(Math.random() * steps);\n        };\n        const pickBase = (values, count)=>{\n            const shuffled = [\n                ...values\n            ].sort(()=>Math.random() - 0.5);\n            return shuffled.slice(0, count);\n        };\n        const normalizeAttributes = (attrs, keys, min, max, baseValues)=>{\n            const result = {\n                ...attrs || {}\n            };\n            const base = baseValues ? pickBase(baseValues, keys.length) : [];\n            keys.forEach((key, index)=>{\n                const raw = result[key] ?? result[key.toLowerCase()];\n                const coerced = coerceNumber(raw);\n                const value = coerced === null ? baseValues ? base[index] : randomInRange(min, max) : coerced;\n                result[key] = clamp(value, min, max);\n            });\n            return result;\n        };\n        const normalizeSkills = (value)=>{\n            if (Array.isArray(value)) {\n                return value.map((v)=>String(v)).map((v)=>v.trim()).filter(Boolean);\n            }\n            if (typeof value === \"string\") {\n                return value.split(\",\").map((s)=>s.trim()).filter(Boolean);\n            }\n            if (value && typeof value === \"object\") {\n                return Object.keys(value).map((s)=>s.trim()).filter(Boolean);\n            }\n            return [];\n        };\n        const normalizeInventory = (value)=>{\n            if (Array.isArray(value)) {\n                return value.map((v)=>String(v)).map((v)=>v.trim()).filter(Boolean);\n            }\n            if (typeof value === \"string\") {\n                return value.split(\",\").map((s)=>s.trim()).filter(Boolean);\n            }\n            return [];\n        };\n        const normalizeClass = (value)=>{\n            const raw = normalizeString(value);\n            if (!classOptions.length || normalizedSystem === \"Narrativo\") {\n                return raw || classOptions[0] || \"Aventureiro\";\n            }\n            const match = classOptions.find((c)=>c.toLowerCase() === raw.toLowerCase());\n            if (match) return match;\n            const fuzzy = classOptions.find((c)=>raw && c.toLowerCase().includes(raw.toLowerCase()));\n            return fuzzy || classOptions[0];\n        };\n        const pickSkills = (source, min, max)=>{\n            if (source.length === 0) return [];\n            const count = Math.max(min, Math.min(max, Math.floor(Math.random() * (max - min + 1)) + min));\n            const shuffled = [\n                ...source\n            ].sort(()=>Math.random() - 0.5);\n            return shuffled.slice(0, Math.min(count, shuffled.length));\n        };\n        const limitSkills = (skills, min, max)=>{\n            if (skills.length <= max) return skills;\n            const shuffled = [\n                ...skills\n            ].sort(()=>Math.random() - 0.5);\n            const count = Math.max(min, Math.min(max, shuffled.length));\n            return shuffled.slice(0, count);\n        };\n        const ensureNumber = (value, label, min, max)=>{\n            if (typeof value !== \"number\" || Number.isNaN(value)) {\n                warnings.push(`${label} inválido`);\n                return;\n            }\n            if (min !== undefined && value < min) warnings.push(`${label} abaixo do mínimo (${min})`);\n            if (max !== undefined && value > max) warnings.push(`${label} acima do máximo (${max})`);\n        };\n        const ensureAttributesRange = (keys, min, max)=>{\n            if (!obj.attributes || typeof obj.attributes !== \"object\") {\n                warnings.push(\"Atributos inv\\xe1lidos\");\n                return;\n            }\n            keys.forEach((key)=>{\n                const value = obj.attributes[key];\n                ensureNumber(value, `Atributo ${key}`, min, max);\n            });\n        };\n        if (normalizedSystem === \"D&D 5e\") {\n            obj.attributes = normalizeAttributes(obj.attributes, [\n                \"for\\xe7a\",\n                \"destreza\",\n                \"constitui\\xe7\\xe3o\",\n                \"intelig\\xeancia\",\n                \"sabedoria\",\n                \"carisma\"\n            ], 1, 20, [\n                15,\n                14,\n                13,\n                12,\n                10,\n                8\n            ]);\n            ensureAttributesRange([\n                \"for\\xe7a\",\n                \"destreza\",\n                \"constitui\\xe7\\xe3o\",\n                \"intelig\\xeancia\",\n                \"sabedoria\",\n                \"carisma\"\n            ], 1, 20);\n        }\n        if (normalizedSystem === \"Ordem Paranormal\") {\n            obj.attributes = normalizeAttributes(obj.attributes, [\n                \"for\\xe7a\",\n                \"agilidade\",\n                \"intelecto\",\n                \"presen\\xe7a\",\n                \"vigor\"\n            ], 1, 5, [\n                4,\n                3,\n                3,\n                2,\n                2\n            ]);\n            ensureAttributesRange([\n                \"for\\xe7a\",\n                \"agilidade\",\n                \"intelecto\",\n                \"presen\\xe7a\",\n                \"vigor\"\n            ], 1, 5);\n        }\n        if (normalizedSystem === \"Call of Cthulhu\") {\n            obj.attributes = normalizeAttributes(obj.attributes, [\n                \"for\\xe7a\",\n                \"constitui\\xe7\\xe3o\",\n                \"destreza\",\n                \"intelig\\xeancia\",\n                \"poder\",\n                \"apar\\xeancia\",\n                \"educa\\xe7\\xe3o\",\n                \"tamanho\"\n            ], 1, 100, [\n                70,\n                60,\n                60,\n                50,\n                50,\n                40,\n                40,\n                30\n            ]);\n            ensureNumber(obj.sanity, \"SAN\", 0, 99);\n            ensureNumber(obj.luck, \"Luck\", 0, 99);\n            ensureAttributesRange([\n                \"for\\xe7a\",\n                \"constitui\\xe7\\xe3o\",\n                \"destreza\",\n                \"intelig\\xeancia\",\n                \"poder\",\n                \"apar\\xeancia\",\n                \"educa\\xe7\\xe3o\",\n                \"tamanho\"\n            ], 1, 100);\n        }\n        obj.class_or_role = normalizeClass(obj.class_or_role);\n        obj.profession = normalizeString(obj.profession || profession);\n        const normalizedSkills = normalizeSkills(obj.skills);\n        if (normalizedSkills.length === 0) {\n            const defaults = pickSkills(skillsReference, normalizedSystem === \"Call of Cthulhu\" ? 5 : 4, normalizedSystem === \"Ordem Paranormal\" ? 6 : 5);\n            obj.skills = defaults;\n        } else {\n            const filtered = skillsReference.length ? normalizedSkills.filter((s)=>skillsReference.some((ref)=>ref.toLowerCase() === s.toLowerCase())) : normalizedSkills;\n            const base = filtered.length > 0 ? filtered : normalizedSkills;\n            const limited = limitSkills(base, normalizedSystem === \"Call of Cthulhu\" ? 6 : 4, normalizedSystem === \"Ordem Paranormal\" ? 7 : 6);\n            obj.skills = limited;\n        }\n        obj.inventory = normalizeInventory(obj.inventory);\n        obj.hp = coerceNumber(obj.hp) ?? obj.hp;\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            character: obj,\n            warnings\n        });\n    } catch (error) {\n        console.error(\"Character inference error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2NoYXJhY3Rlci1pbmZlci9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUEyQztBQUNmO0FBQ0o7QUFDNkI7QUFDc0Q7QUFDakQ7QUFDSTtBQUU5RCxNQUFNVSxhQUFhUix1Q0FBUSxDQUFDO0lBQzFCVSxZQUFZVix1Q0FBUTtJQUNwQlksTUFBTVosdUNBQVE7SUFDZGEsWUFBWWIsdUNBQVE7SUFDcEJjLFdBQVdkLHVDQUFRO0lBQ25CZSxZQUFZZix1Q0FBUSxHQUFHZ0IsUUFBUTtBQUNqQztBQUVBLE1BQU1DLGtCQUFrQmpCLHVDQUFRLENBQUM7SUFDL0JrQixlQUFlbEIsdUNBQVE7SUFDdkJlLFlBQVlmLHVDQUFRLEdBQUdnQixRQUFRO0lBQy9CRyxZQUFZbkIsdUNBQVEsQ0FBQ0EsdUNBQVE7SUFDN0JzQixRQUFRdEIsc0NBQU8sQ0FBQztRQUFDQSxzQ0FBTyxDQUFDQSx1Q0FBUTtRQUFLQSx1Q0FBUTtRQUFJQSx1Q0FBUSxDQUFDQSxvQ0FBSztLQUFJO0lBQ3BFMEIsSUFBSTFCLHNDQUFPLENBQUM7UUFBQ0EsdUNBQVE7UUFBSUEsdUNBQVE7S0FBRztJQUNwQzJCLFdBQVczQixzQ0FBTyxDQUFDO1FBQUNBLHNDQUFPLENBQUNBLHVDQUFRO1FBQUtBLHVDQUFRO0tBQUc7SUFDcEQ0QixPQUFPNUIsdUNBQVEsR0FBR2dCLFFBQVE7SUFDMUIsa0NBQWtDO0lBQ2xDYSxRQUFRN0IsdUNBQVEsR0FBR2dCLFFBQVE7SUFDM0JjLE1BQU05Qix1Q0FBUSxHQUFHZ0IsUUFBUTtJQUN6QmUsVUFBVS9CLHVDQUFRLEdBQUdnQixRQUFRO0lBQzdCZ0IsWUFBWWhDLHVDQUFRLEdBQUdnQixRQUFRO0lBQy9CaUIsS0FBS2pDLHVDQUFRLEdBQUdnQixRQUFRO0lBQ3hCa0IsWUFBWWxDLHVDQUFRLEdBQUdnQixRQUFRO0lBQy9CbUIsTUFBTW5DLHVDQUFRLEdBQUdnQixRQUFRO0lBQ3pCb0IsU0FBU3BDLHVDQUFRLEdBQUdnQixRQUFRO0lBQzVCcUIsT0FBT3JDLHVDQUFRLEdBQUdnQixRQUFRO0lBQzFCc0IsV0FBV3RDLHVDQUFRLEdBQUdnQixRQUFRO0lBQzlCdUIsaUJBQWlCdkMsd0NBQVMsR0FBR2dCLFFBQVE7SUFDckN5QixjQUFjekMsdUNBQVEsR0FBR2dCLFFBQVE7SUFDakMwQixNQUFNMUMsdUNBQVEsR0FBR2dCLFFBQVE7SUFDekIyQixZQUFZM0MsdUNBQVEsR0FBR2dCLFFBQVE7QUFDakM7QUFFTyxlQUFlNEIsS0FBS0MsR0FBWTtJQUNyQyxJQUFJO1FBQ0YsTUFBTUMsVUFBVUQsSUFBSUUsT0FBTyxDQUFDQyxHQUFHLENBQUMsdUJBQXVCQztRQUV2RCxNQUFNQyxLQUFLLENBQUNMLElBQUlFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLHNCQUFzQixTQUFRLEVBQUdHLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDQyxJQUFJO1FBQy9FLE1BQU1DLFVBQVUsQ0FBQyxNQUFNLEVBQUVILEdBQUcsQ0FBQztRQUM3QixJQUFJLE1BQU01QyxnRUFBYUEsQ0FBQytDLFVBQVU7WUFDaEMsT0FBT3ZELHFEQUFZQSxDQUFDd0QsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQXNCLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUMzRTtRQUVBLE1BQU1GLE9BQU8sTUFBTVQsSUFBSVMsSUFBSTtRQUMzQixNQUFNRyxTQUFTakQsV0FBV2tELFNBQVMsQ0FBQ0o7UUFDcEMsSUFBSSxDQUFDRyxPQUFPRSxPQUFPLEVBQUU7WUFDbkIsT0FBTzdELHFEQUFZQSxDQUFDd0QsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQWtCLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUN2RTtRQUVBLE1BQU0sRUFBRTlDLFVBQVUsRUFBRUUsSUFBSSxFQUFFQyxVQUFVLEVBQUVDLFNBQVMsRUFBRUMsVUFBVSxFQUFFLEdBQUcwQyxPQUFPRyxJQUFJO1FBQzNFLE1BQU1DLG1CQUFtQjFELCtEQUFtQkEsQ0FBQ087UUFDN0MsTUFBTW9ELFFBQVE1RCxtREFBVyxDQUFDMkQsaUJBQWlCLElBQUkzRCxtREFBVyxDQUFDLFlBQVk7UUFDdkUsTUFBTTZELGtCQUFrQjNELHdEQUFnQixDQUFDeUQsaUJBQWlCLElBQUksRUFBRTtRQUNoRSxNQUFNRyxlQUFlM0QseURBQWlCLENBQUN3RCxpQkFBaUIsSUFBSSxFQUFFO1FBRTlELElBQUlJO1FBQ0osSUFBSTtZQUNGQSxTQUFTaEUsMkRBQVVBLENBQUM2QztRQUN0QixFQUFFLE9BQU07WUFDTixPQUFPaEQscURBQVlBLENBQUN3RCxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBa0IsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ3ZFO1FBQ0EsTUFBTVUsS0FBSyxJQUFJbkUsZ0RBQUlBLENBQUM7WUFBRWtFO1FBQU87UUFFN0IsTUFBTUUsYUFBYSxDQUFDO1lBQ2xCLE9BQVFOO2dCQUNOLEtBQUs7b0JBQ0gsT0FBTztnQkFDVCxLQUFLO29CQUNILE9BQU87Z0JBQ1QsS0FBSztvQkFDSCxPQUFPO2dCQUNUO29CQUNFLE9BQU87WUFDWDtRQUNGO1FBRUEsTUFBTU8sYUFBYSxDQUFDLFNBQVMsRUFBRVAsaUJBQWlCLG9CQUFvQixFQUFFQyxNQUFNOzs7T0FHekUsRUFBRWxELEtBQUs7WUFDRixFQUFFQyxXQUFXO1lBQ2IsRUFBRUMsVUFBVTtnQ0FDUSxFQUFFQyxjQUFjLG1CQUFnQjs7QUFFaEUsRUFBRW9ELFdBQVc7OztBQUdiLEVBQUVKLGdCQUFnQk0sR0FBRyxDQUFDLENBQUNDLElBQU0sQ0FBQyxFQUFFLEVBQUVBLEVBQUUsQ0FBQyxFQUFFQyxJQUFJLENBQUMsTUFBTTs7O0FBR2xELEVBQUVQLGFBQWFLLEdBQUcsQ0FBQyxDQUFDRyxJQUFNLENBQUMsRUFBRSxFQUFFQSxFQUFFLENBQUMsRUFBRUQsSUFBSSxDQUFDLE1BQU07Ozs7Ozs7Ozs7OzsyREFZWSxDQUFDO1FBRXhELE1BQU1FLFdBQXFCLEVBQUU7UUFFN0IsTUFBTUMsV0FBVyxPQUFPQztZQUN0QixNQUFNQyxTQUFTLENBQUMsRUFBRVIsV0FBVyxJQUFJLEVBQUVPLE1BQU0sQ0FBQyxDQUFDdkIsSUFBSTtZQUMvQyxPQUFPN0Msb0VBQWlCQSxDQUN0QixDQUFDc0UsUUFDQ1gsR0FBR1ksSUFBSSxDQUFDQyxXQUFXLENBQUNDLE1BQU0sQ0FBQztvQkFDekJIO29CQUNBSSxVQUFVO3dCQUFDOzRCQUFFQyxNQUFNOzRCQUFRQyxTQUFTUDt3QkFBTztxQkFBRTtvQkFDN0NRLGFBQWE7Z0JBQ2YsSUFDRjtnQkFBRUMsS0FBSyxDQUFDLE1BQU0sRUFBRTNFLFdBQVcsQ0FBQztZQUFDO1FBRWpDO1FBRUEsTUFBTTRFLFdBQVc7WUFDZjtZQUNBO1lBQ0E7U0FDRDtRQUVELElBQUlDLGFBQWtCO1FBQ3RCLElBQUlDLFlBQWlCO1FBRXJCLEtBQUssTUFBTWIsU0FBU1csU0FBVTtZQUM1QixNQUFNRyxTQUFTLE1BQU1mLFNBQVNDO1lBQzlCLE1BQU1lLE1BQU1ELE9BQU9FLE9BQU8sRUFBRSxDQUFDLEVBQUUsRUFBRUMsU0FBU1QsV0FBVztZQUNyRCxNQUFNVSxZQUFZSCxJQUFJSSxLQUFLLENBQUM7WUFDNUIsSUFBSSxDQUFDRCxXQUFXO1lBQ2hCLElBQUk7Z0JBQ0ZOLGFBQWFRLEtBQUtDLEtBQUssQ0FBQ0gsU0FBUyxDQUFDLEVBQUU7WUFDdEMsRUFBRSxPQUFPSSxHQUFHO2dCQUNWO1lBQ0Y7WUFDQSxNQUFNQyxZQUFZakYsZ0JBQWdCeUMsU0FBUyxDQUFDNkI7WUFDNUMsSUFBSVcsVUFBVXZDLE9BQU8sRUFBRTtnQkFDckI2QixZQUFZVTtnQkFDWjtZQUNGO1FBQ0Y7UUFFQSxJQUFJLENBQUNWLFdBQVc3QixTQUFTO1lBQ3ZCYyxTQUFTMEIsSUFBSSxDQUFDO1lBQ2QsT0FBT3JHLHFEQUFZQSxDQUFDd0QsSUFBSSxDQUFDO2dCQUFFOEMsV0FBV2IsY0FBYyxDQUFDO2dCQUFHZDtZQUFTO1FBQ25FO1FBRUEsTUFBTTRCLE1BQU1iLFVBQVU1QixJQUFJO1FBRTFCLE1BQU0wQyxrQkFBa0IsQ0FBQ0M7WUFDdkIsSUFBSSxPQUFPQSxVQUFVLFVBQVUsT0FBT0EsTUFBTW5ELElBQUk7WUFDaEQsSUFBSW1ELFVBQVUsUUFBUUEsVUFBVXRELFdBQVcsT0FBTztZQUNsRCxPQUFPdUQsT0FBT0QsT0FBT25ELElBQUk7UUFDM0I7UUFFQSxNQUFNcUQsZUFBZSxDQUFDRjtZQUNwQixJQUFJLE9BQU9BLFVBQVUsWUFBWUcsT0FBT0MsUUFBUSxDQUFDSixRQUFRLE9BQU9BO1lBQ2hFLElBQUksT0FBT0EsVUFBVSxVQUFVO2dCQUM3QixNQUFNOUMsU0FBU2lELE9BQU9ILE1BQU1LLE9BQU8sQ0FBQyxLQUFLO2dCQUN6QyxPQUFPRixPQUFPQyxRQUFRLENBQUNsRCxVQUFVQSxTQUFTO1lBQzVDO1lBQ0EsT0FBTztRQUNUO1FBRUEsTUFBTW9ELFFBQVEsQ0FBQ04sT0FBZU8sS0FBYUMsTUFBZ0JDLEtBQUtGLEdBQUcsQ0FBQ0MsS0FBS0MsS0FBS0QsR0FBRyxDQUFDRCxLQUFLUDtRQUV2RixNQUFNVSxnQkFBZ0IsQ0FBQ0gsS0FBYUMsS0FBYUcsT0FBTyxDQUFDO1lBQ3ZELE1BQU1DLFFBQVFILEtBQUtJLEtBQUssQ0FBQyxDQUFDTCxNQUFNRCxHQUFFLElBQUtJLFFBQVE7WUFDL0MsT0FBT0osTUFBTUksT0FBT0YsS0FBS0ksS0FBSyxDQUFDSixLQUFLSyxNQUFNLEtBQUtGO1FBQ2pEO1FBRUEsTUFBTUcsV0FBVyxDQUFDQyxRQUFrQkM7WUFDbEMsTUFBTUMsV0FBVzttQkFBSUY7YUFBTyxDQUFDRyxJQUFJLENBQUMsSUFBTVYsS0FBS0ssTUFBTSxLQUFLO1lBQ3hELE9BQU9JLFNBQVNFLEtBQUssQ0FBQyxHQUFHSDtRQUMzQjtRQUVBLE1BQU1JLHNCQUFzQixDQUMxQkMsT0FDQUMsTUFDQWhCLEtBQ0FDLEtBQ0FnQjtZQUVBLE1BQU10QyxTQUE4QjtnQkFBRSxHQUFJb0MsU0FBUyxDQUFDLENBQUM7WUFBRTtZQUN2RCxNQUFNRyxPQUFPRCxhQUFhVCxTQUFTUyxZQUFZRCxLQUFLRyxNQUFNLElBQUksRUFBRTtZQUNoRUgsS0FBS0ksT0FBTyxDQUFDLENBQUM3QyxLQUFLOEM7Z0JBQ2pCLE1BQU16QyxNQUFNRCxNQUFNLENBQUNKLElBQUksSUFBSUksTUFBTSxDQUFDSixJQUFJK0MsV0FBVyxHQUFHO2dCQUNwRCxNQUFNQyxVQUFVNUIsYUFBYWY7Z0JBQzdCLE1BQU1hLFFBQVE4QixZQUFZLE9BQ3JCTixhQUFhQyxJQUFJLENBQUNHLE1BQU0sR0FBR2xCLGNBQWNILEtBQUtDLE9BQy9Dc0I7Z0JBQ0o1QyxNQUFNLENBQUNKLElBQUksR0FBR3dCLE1BQU1OLE9BQU9PLEtBQUtDO1lBQ2xDO1lBQ0EsT0FBT3RCO1FBQ1Q7UUFFQSxNQUFNNkMsa0JBQWtCLENBQUMvQjtZQUN2QixJQUFJZ0MsTUFBTUMsT0FBTyxDQUFDakMsUUFBUTtnQkFDeEIsT0FBT0EsTUFBTWxDLEdBQUcsQ0FBQyxDQUFDb0UsSUFBTWpDLE9BQU9pQyxJQUFJcEUsR0FBRyxDQUFDLENBQUNvRSxJQUFNQSxFQUFFckYsSUFBSSxJQUFJc0YsTUFBTSxDQUFDQztZQUNqRTtZQUNBLElBQUksT0FBT3BDLFVBQVUsVUFBVTtnQkFDN0IsT0FBT0EsTUFBTXBELEtBQUssQ0FBQyxLQUFLa0IsR0FBRyxDQUFDLENBQUNDLElBQU1BLEVBQUVsQixJQUFJLElBQUlzRixNQUFNLENBQUNDO1lBQ3REO1lBQ0EsSUFBSXBDLFNBQVMsT0FBT0EsVUFBVSxVQUFVO2dCQUN0QyxPQUFPcUMsT0FBT2QsSUFBSSxDQUFDdkIsT0FBT2xDLEdBQUcsQ0FBQyxDQUFDQyxJQUFNQSxFQUFFbEIsSUFBSSxJQUFJc0YsTUFBTSxDQUFDQztZQUN4RDtZQUNBLE9BQU8sRUFBRTtRQUNYO1FBRUEsTUFBTUUscUJBQXFCLENBQUN0QztZQUMxQixJQUFJZ0MsTUFBTUMsT0FBTyxDQUFDakMsUUFBUTtnQkFDeEIsT0FBT0EsTUFBTWxDLEdBQUcsQ0FBQyxDQUFDb0UsSUFBTWpDLE9BQU9pQyxJQUFJcEUsR0FBRyxDQUFDLENBQUNvRSxJQUFNQSxFQUFFckYsSUFBSSxJQUFJc0YsTUFBTSxDQUFDQztZQUNqRTtZQUNBLElBQUksT0FBT3BDLFVBQVUsVUFBVTtnQkFDN0IsT0FBT0EsTUFBTXBELEtBQUssQ0FBQyxLQUFLa0IsR0FBRyxDQUFDLENBQUNDLElBQU1BLEVBQUVsQixJQUFJLElBQUlzRixNQUFNLENBQUNDO1lBQ3REO1lBQ0EsT0FBTyxFQUFFO1FBQ1g7UUFFQSxNQUFNRyxpQkFBaUIsQ0FBQ3ZDO1lBQ3RCLE1BQU1iLE1BQU1ZLGdCQUFnQkM7WUFDNUIsSUFBSSxDQUFDdkMsYUFBYWlFLE1BQU0sSUFBSXBFLHFCQUFxQixhQUFhO2dCQUM1RCxPQUFPNkIsT0FBUTFCLFlBQVksQ0FBQyxFQUFFLElBQUk7WUFDcEM7WUFDQSxNQUFNOEIsUUFBUTlCLGFBQWErRSxJQUFJLENBQUMsQ0FBQ3ZFLElBQU1BLEVBQUU0RCxXQUFXLE9BQU8xQyxJQUFJMEMsV0FBVztZQUMxRSxJQUFJdEMsT0FBTyxPQUFPQTtZQUNsQixNQUFNa0QsUUFBUWhGLGFBQWErRSxJQUFJLENBQUMsQ0FBQ3ZFLElBQU1rQixPQUFPbEIsRUFBRTRELFdBQVcsR0FBR2EsUUFBUSxDQUFDdkQsSUFBSTBDLFdBQVc7WUFDdEYsT0FBT1ksU0FBU2hGLFlBQVksQ0FBQyxFQUFFO1FBQ2pDO1FBRUEsTUFBTWtGLGFBQWEsQ0FBQ0MsUUFBa0JyQyxLQUFhQztZQUNqRCxJQUFJb0MsT0FBT2xCLE1BQU0sS0FBSyxHQUFHLE9BQU8sRUFBRTtZQUNsQyxNQUFNVCxRQUFRUixLQUFLRCxHQUFHLENBQUNELEtBQUtFLEtBQUtGLEdBQUcsQ0FBQ0MsS0FBS0MsS0FBS0ksS0FBSyxDQUFDSixLQUFLSyxNQUFNLEtBQU1OLENBQUFBLE1BQU1ELE1BQU0sTUFBTUE7WUFDeEYsTUFBTVcsV0FBVzttQkFBSTBCO2FBQU8sQ0FBQ3pCLElBQUksQ0FBQyxJQUFNVixLQUFLSyxNQUFNLEtBQUs7WUFDeEQsT0FBT0ksU0FBU0UsS0FBSyxDQUFDLEdBQUdYLEtBQUtGLEdBQUcsQ0FBQ1UsT0FBT0MsU0FBU1EsTUFBTTtRQUMxRDtRQUVBLE1BQU1tQixjQUFjLENBQUM5SCxRQUFrQndGLEtBQWFDO1lBQ2xELElBQUl6RixPQUFPMkcsTUFBTSxJQUFJbEIsS0FBSyxPQUFPekY7WUFDakMsTUFBTW1HLFdBQVc7bUJBQUluRzthQUFPLENBQUNvRyxJQUFJLENBQUMsSUFBTVYsS0FBS0ssTUFBTSxLQUFLO1lBQ3hELE1BQU1HLFFBQVFSLEtBQUtELEdBQUcsQ0FBQ0QsS0FBS0UsS0FBS0YsR0FBRyxDQUFDQyxLQUFLVSxTQUFTUSxNQUFNO1lBQ3pELE9BQU9SLFNBQVNFLEtBQUssQ0FBQyxHQUFHSDtRQUMzQjtRQUVBLE1BQU02QixlQUFlLENBQUM5QyxPQUFZK0MsT0FBZXhDLEtBQWNDO1lBQzdELElBQUksT0FBT1IsVUFBVSxZQUFZRyxPQUFPNkMsS0FBSyxDQUFDaEQsUUFBUTtnQkFDcEQ5QixTQUFTMEIsSUFBSSxDQUFDLENBQUMsRUFBRW1ELE1BQU0sU0FBUyxDQUFDO2dCQUNqQztZQUNGO1lBQ0EsSUFBSXhDLFFBQVE3RCxhQUFhc0QsUUFBUU8sS0FBS3JDLFNBQVMwQixJQUFJLENBQUMsQ0FBQyxFQUFFbUQsTUFBTSxtQkFBbUIsRUFBRXhDLElBQUksQ0FBQyxDQUFDO1lBQ3hGLElBQUlDLFFBQVE5RCxhQUFhc0QsUUFBUVEsS0FBS3RDLFNBQVMwQixJQUFJLENBQUMsQ0FBQyxFQUFFbUQsTUFBTSxrQkFBa0IsRUFBRXZDLElBQUksQ0FBQyxDQUFDO1FBQ3pGO1FBRUEsTUFBTXlDLHdCQUF3QixDQUFDMUIsTUFBZ0JoQixLQUFhQztZQUMxRCxJQUFJLENBQUNWLElBQUlsRixVQUFVLElBQUksT0FBT2tGLElBQUlsRixVQUFVLEtBQUssVUFBVTtnQkFDekRzRCxTQUFTMEIsSUFBSSxDQUFDO2dCQUNkO1lBQ0Y7WUFDQTJCLEtBQUtJLE9BQU8sQ0FBQyxDQUFDN0M7Z0JBQ1osTUFBTWtCLFFBQVFGLElBQUlsRixVQUFVLENBQUNrRSxJQUFJO2dCQUNqQ2dFLGFBQWE5QyxPQUFPLENBQUMsU0FBUyxFQUFFbEIsSUFBSSxDQUFDLEVBQUV5QixLQUFLQztZQUM5QztRQUNGO1FBRUEsSUFBSWxELHFCQUFxQixVQUFVO1lBQ2pDd0MsSUFBSWxGLFVBQVUsR0FBR3lHLG9CQUNmdkIsSUFBSWxGLFVBQVUsRUFDZDtnQkFBQztnQkFBUztnQkFBWTtnQkFBZ0I7Z0JBQWdCO2dCQUFhO2FBQVUsRUFDN0UsR0FDQSxJQUNBO2dCQUFDO2dCQUFJO2dCQUFJO2dCQUFJO2dCQUFJO2dCQUFJO2FBQUU7WUFFekJxSSxzQkFDRTtnQkFBQztnQkFBUztnQkFBWTtnQkFBZ0I7Z0JBQWdCO2dCQUFhO2FBQVUsRUFDN0UsR0FDQTtRQUVKO1FBRUEsSUFBSTNGLHFCQUFxQixvQkFBb0I7WUFDM0N3QyxJQUFJbEYsVUFBVSxHQUFHeUcsb0JBQ2Z2QixJQUFJbEYsVUFBVSxFQUNkO2dCQUFDO2dCQUFTO2dCQUFhO2dCQUFhO2dCQUFZO2FBQVEsRUFDeEQsR0FDQSxHQUNBO2dCQUFDO2dCQUFHO2dCQUFHO2dCQUFHO2dCQUFHO2FBQUU7WUFFakJxSSxzQkFBc0I7Z0JBQUM7Z0JBQVM7Z0JBQWE7Z0JBQWE7Z0JBQVk7YUFBUSxFQUFFLEdBQUc7UUFDckY7UUFFQSxJQUFJM0YscUJBQXFCLG1CQUFtQjtZQUMxQ3dDLElBQUlsRixVQUFVLEdBQUd5RyxvQkFDZnZCLElBQUlsRixVQUFVLEVBQ2Q7Z0JBQUM7Z0JBQVM7Z0JBQWdCO2dCQUFZO2dCQUFnQjtnQkFBUztnQkFBYTtnQkFBWTthQUFVLEVBQ2xHLEdBQ0EsS0FDQTtnQkFBQztnQkFBSTtnQkFBSTtnQkFBSTtnQkFBSTtnQkFBSTtnQkFBSTtnQkFBSTthQUFHO1lBRWxDa0ksYUFBYWhELElBQUl4RSxNQUFNLEVBQUUsT0FBTyxHQUFHO1lBQ25Dd0gsYUFBYWhELElBQUl2RSxJQUFJLEVBQUUsUUFBUSxHQUFHO1lBQ2xDMEgsc0JBQ0U7Z0JBQUM7Z0JBQVM7Z0JBQWdCO2dCQUFZO2dCQUFnQjtnQkFBUztnQkFBYTtnQkFBWTthQUFVLEVBQ2xHLEdBQ0E7UUFFSjtRQUVBbkQsSUFBSW5GLGFBQWEsR0FBRzRILGVBQWV6QyxJQUFJbkYsYUFBYTtRQUNwRG1GLElBQUl0RixVQUFVLEdBQUd1RixnQkFBZ0JELElBQUl0RixVQUFVLElBQUlBO1FBRW5ELE1BQU0wSSxtQkFBbUJuQixnQkFBZ0JqQyxJQUFJL0UsTUFBTTtRQUNuRCxJQUFJbUksaUJBQWlCeEIsTUFBTSxLQUFLLEdBQUc7WUFDakMsTUFBTXlCLFdBQVdSLFdBQ2ZuRixpQkFDQUYscUJBQXFCLG9CQUFvQixJQUFJLEdBQzdDQSxxQkFBcUIscUJBQXFCLElBQUk7WUFFaER3QyxJQUFJL0UsTUFBTSxHQUFHb0k7UUFDZixPQUFPO1lBQ0wsTUFBTUMsV0FBVzVGLGdCQUFnQmtFLE1BQU0sR0FDbkN3QixpQkFBaUJmLE1BQU0sQ0FBQyxDQUFDcEUsSUFBTVAsZ0JBQWdCNkYsSUFBSSxDQUFDLENBQUNDLE1BQVFBLElBQUl6QixXQUFXLE9BQU85RCxFQUFFOEQsV0FBVyxPQUNoR3FCO1lBQ0osTUFBTXpCLE9BQU8yQixTQUFTMUIsTUFBTSxHQUFHLElBQUkwQixXQUFXRjtZQUM5QyxNQUFNSyxVQUFVVixZQUNkcEIsTUFDQW5FLHFCQUFxQixvQkFBb0IsSUFBSSxHQUM3Q0EscUJBQXFCLHFCQUFxQixJQUFJO1lBRWhEd0MsSUFBSS9FLE1BQU0sR0FBR3dJO1FBQ2Y7UUFFQXpELElBQUkxRSxTQUFTLEdBQUdrSCxtQkFBbUJ4QyxJQUFJMUUsU0FBUztRQUNoRDBFLElBQUkzRSxFQUFFLEdBQUcrRSxhQUFhSixJQUFJM0UsRUFBRSxLQUFLMkUsSUFBSTNFLEVBQUU7UUFFdkMsT0FBTzVCLHFEQUFZQSxDQUFDd0QsSUFBSSxDQUFDO1lBQUU4QyxXQUFXQztZQUFLNUI7UUFBUztJQUN0RCxFQUFFLE9BQU9sQixPQUFZO1FBQ25Cd0csUUFBUXhHLEtBQUssQ0FBQyw4QkFBOEJBO1FBQzVDLE9BQU96RCxxREFBWUEsQ0FBQ3dELElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQWUsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDcEU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RyYWktLS12aXJ0dWFsLXRhYmxldG9wLy4vYXBwL2FwaS9jaGFyYWN0ZXItaW5mZXIvcm91dGUudHM/MzFmZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgR3JvcSBmcm9tICdncm9xLXNkayc7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcbmltcG9ydCB7IHBpY2tBcGlLZXkgfSBmcm9tICcuLi8uLi8uLi9saWIvYWkva2V5UG9vbCc7XG5pbXBvcnQgeyBSUEdfU1lTVEVNUywgbm9ybWFsaXplU3lzdGVtTmFtZSwgU0tJTExTX0JZX1NZU1RFTSwgQ0xBU1NFU19CWV9TWVNURU0gfSBmcm9tICcuLi8uLi8uLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgaXNSYXRlTGltaXRlZCB9IGZyb20gJy4uLy4uLy4uL2xpYi9haS9yYXRlTGltaXQnO1xuaW1wb3J0IHsgd2l0aE1vZGVsRmFsbGJhY2sgfSBmcm9tICcuLi8uLi8uLi9saWIvYWkvbW9kZWxQb29sJztcblxuY29uc3QgYm9keVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgc3lzdGVtTmFtZTogei5zdHJpbmcoKSxcbiAgbmFtZTogei5zdHJpbmcoKSxcbiAgYXBwZWFyYW5jZTogei5zdHJpbmcoKSxcbiAgYmFja3N0b3J5OiB6LnN0cmluZygpLFxuICBwcm9mZXNzaW9uOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG59KTtcblxuY29uc3QgY2hhcmFjdGVyU2NoZW1hID0gei5vYmplY3Qoe1xuICBjbGFzc19vcl9yb2xlOiB6LnN0cmluZygpLFxuICBwcm9mZXNzaW9uOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGF0dHJpYnV0ZXM6IHoucmVjb3JkKHoubnVtYmVyKCkpLFxuICBza2lsbHM6IHoudW5pb24oW3ouYXJyYXkoei5zdHJpbmcoKSksIHouc3RyaW5nKCksIHoucmVjb3JkKHouYW55KCkpXSksXG4gIGhwOiB6LnVuaW9uKFt6Lm51bWJlcigpLCB6LnN0cmluZygpXSksXG4gIGludmVudG9yeTogei51bmlvbihbei5hcnJheSh6LnN0cmluZygpKSwgei5zdHJpbmcoKV0pLFxuICBub3Rlczogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAvLyBTeXN0ZW0tc3BlY2lmaWMgb3B0aW9uYWwgZmllbGRzXG4gIHNhbml0eTogei5udW1iZXIoKS5vcHRpb25hbCgpLFxuICBsdWNrOiB6Lm51bWJlcigpLm9wdGlvbmFsKCksXG4gIGh1bWFuaXR5OiB6Lm51bWJlcigpLm9wdGlvbmFsKCksXG4gIGJsb29kX3Bvb2w6IHoubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgZW1wOiB6Lm51bWJlcigpLm9wdGlvbmFsKCksXG4gIHJlcHV0YXRpb246IHoubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgbWFuYTogei5udW1iZXIoKS5vcHRpb25hbCgpLFxuICBzdGFtaW5hOiB6Lm51bWJlcigpLm9wdGlvbmFsKCksXG4gIGZvY3VzOiB6Lm51bWJlcigpLm9wdGlvbmFsKCksXG4gIGFsaWdubWVudDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBmb3JjZV9zZW5zaXRpdmU6IHouYm9vbGVhbigpLm9wdGlvbmFsKCksXG4gIGZvcmNlX3JhdGluZzogei5udW1iZXIoKS5vcHRpb25hbCgpLFxuICBncml0OiB6Lm51bWJlcigpLm9wdGlvbmFsKCksXG4gIGNvcnJ1cHRpb246IHoubnVtYmVyKCkub3B0aW9uYWwoKSxcbn0pO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXE6IFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyS2V5ID0gcmVxLmhlYWRlcnMuZ2V0KCd4LWN1c3RvbS1hcGkta2V5JykgfHwgdW5kZWZpbmVkO1xuXG4gICAgY29uc3QgaXAgPSAocmVxLmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKSB8fCAndW5rbm93bicpLnNwbGl0KCcsJylbMF0udHJpbSgpO1xuICAgIGNvbnN0IHJhdGVLZXkgPSBgaW5mZXI6JHtpcH1gO1xuICAgIGlmIChhd2FpdCBpc1JhdGVMaW1pdGVkKHJhdGVLZXkpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ1JhdGUgbGltaXQgZXhjZWVkZWQnIH0sIHsgc3RhdHVzOiA0MjkgfSk7XG4gICAgfVxuXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcS5qc29uKCk7XG4gICAgY29uc3QgcGFyc2VkID0gYm9keVNjaGVtYS5zYWZlUGFyc2UoanNvbik7XG4gICAgaWYgKCFwYXJzZWQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIHBheWxvYWQnIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgeyBzeXN0ZW1OYW1lLCBuYW1lLCBhcHBlYXJhbmNlLCBiYWNrc3RvcnksIHByb2Zlc3Npb24gfSA9IHBhcnNlZC5kYXRhO1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRTeXN0ZW0gPSBub3JtYWxpemVTeXN0ZW1OYW1lKHN5c3RlbU5hbWUpO1xuICAgIGNvbnN0IHJ1bGVzID0gUlBHX1NZU1RFTVNbbm9ybWFsaXplZFN5c3RlbV0gfHwgUlBHX1NZU1RFTVNbJ05hcnJhdGl2byddO1xuICAgIGNvbnN0IHNraWxsc1JlZmVyZW5jZSA9IFNLSUxMU19CWV9TWVNURU1bbm9ybWFsaXplZFN5c3RlbV0gfHwgW107XG4gICAgY29uc3QgY2xhc3NPcHRpb25zID0gQ0xBU1NFU19CWV9TWVNURU1bbm9ybWFsaXplZFN5c3RlbV0gfHwgW107XG5cbiAgICBsZXQgYXBpS2V5OiBzdHJpbmc7XG4gICAgdHJ5IHtcbiAgICAgIGFwaUtleSA9IHBpY2tBcGlLZXkodXNlcktleSk7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ01pc3NpbmcgQVBJIGtleScgfSwgeyBzdGF0dXM6IDQwMSB9KTtcbiAgICB9XG4gICAgY29uc3QgYWkgPSBuZXcgR3JvcSh7IGFwaUtleSB9KTtcblxuICAgIGNvbnN0IHN5c3RlbUhpbnQgPSAoKCkgPT4ge1xuICAgICAgc3dpdGNoIChub3JtYWxpemVkU3lzdGVtKSB7XG4gICAgICAgIGNhc2UgJ0QmRCA1ZSc6XG4gICAgICAgICAgcmV0dXJuICdVc2UgYXRyaWJ1dG9zIGVtIHBvcnR1Z3XDqnM6IGZvcsOnYSwgZGVzdHJlemEsIGNvbnN0aXR1acOnw6NvLCBpbnRlbGlnw6puY2lhLCBzYWJlZG9yaWEsIGNhcmlzbWEuIFZhbG9yZXMgOC0xOC4gSW5jbHVhIGNsYXNzX29yX3JvbGUgZSBocCBjb2VyZW50ZXMgY29tIG8gYmFja3N0b3J5Lic7XG4gICAgICAgIGNhc2UgJ09yZGVtIFBhcmFub3JtYWwnOlxuICAgICAgICAgIHJldHVybiAnVXNlIGF0cmlidXRvcyBlbSBwb3J0dWd1w6pzOiBmb3LDp2EsIGFnaWxpZGFkZSwgaW50ZWxlY3RvLCBwcmVzZW7Dp2EsIHZpZ29yLiBWYWxvcmVzIDEtNSAocGFkcsOjbyksIGNvZXJlbnRlcyBjb20gbyBiYWNrc3RvcnkuIEluY2x1YSBjbGFzc19vcl9yb2xlIGUgaHAgY29lcmVudGVzLic7XG4gICAgICAgIGNhc2UgJ0NhbGwgb2YgQ3RodWxodSc6XG4gICAgICAgICAgcmV0dXJuICdVc2UgYXRyaWJ1dG9zIGVtIHBvcnR1Z3XDqnM6IGZvcsOnYSwgY29uc3RpdHVpw6fDo28sIGRlc3RyZXphLCBpbnRlbGlnw6puY2lhLCBwb2RlciwgYXBhcsOqbmNpYSwgZWR1Y2HDp8OjbywgdGFtYW5oby4gVmFsb3JlcyAyMC05MC4gSW5jbHVhIHNhbml0eSBlIGx1Y2sgY29tbyBuw7ptZXJvcyAoMC05OSkuJztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICByZXR1cm4gJ0luY2x1YSBhcGVuYXMgY2FtcG9zIHJlbGV2YW50ZXMgZSBjb2VyZW50ZXMgY29tIG8gYmFja3N0b3J5Lic7XG4gICAgICB9XG4gICAgfSkoKTtcblxuICAgIGNvbnN0IHByb21wdEJhc2UgPSBgU2lzdGVtYTogJHtub3JtYWxpemVkU3lzdGVtfS4gUmVncmFzIHJlc3VtaWRhczogJHtydWxlc31cblxuQ3JpZSB1bWEgZmljaGEgSlNPTiBwYXJhIG8gcGVyc29uYWdlbSB1c2FuZG8gb3MgZGFkb3M6XG4gTm9tZTogJHtuYW1lfVxuIEFwYXLDqm5jaWE6ICR7YXBwZWFyYW5jZX1cbiBCYWNrc3Rvcnk6ICR7YmFja3N0b3J5fVxuIFByb2Zpc3PDo28vT2N1cGHDp8OjbyAob3BjaW9uYWwpOiAke3Byb2Zlc3Npb24gfHwgJ27Do28gaW5mb3JtYWRhJ31cblxuJHtzeXN0ZW1IaW50fVxuXG5MaXN0YSBkZSBwZXLDrWNpYXMgcGVybWl0aWRhcyAodXNlIGFwZW5hcyBlc3NhcyBjb21vIHJlZmVyw6puY2lhKTpcbiR7c2tpbGxzUmVmZXJlbmNlLm1hcCgocykgPT4gYC0gJHtzfWApLmpvaW4oJ1xcbicpfVxuXG5DbGFzc2VzL3JvbGVzIHBlcm1pdGlkYXMgKGVzY29saGEgVU1BKTpcbiR7Y2xhc3NPcHRpb25zLm1hcCgoYykgPT4gYC0gJHtjfWApLmpvaW4oJ1xcbicpfVxuXG4gIFJFR1JBUyBDUsONVElDQVM6XG4gIC0gU0VNUFJFIHByZWVuY2hhOiBjbGFzc19vcl9yb2xlLCBhdHRyaWJ1dGVzLCBza2lsbHMsIGhwLCBpbnZlbnRvcnkuXG4gIC0gQXMgcGVyw61jaWFzIERFVkVNIHNlciBpbmZlcmlkYXMgYSBwYXJ0aXIgZG8gYmFja3N0b3J5IChwcm9maXNzw6NvLCBwYXNzYWRvLCB0cmF1bWFzLCB0cmVpbmFtZW50bywgZXhwZXJpw6puY2lhcykuXG4gIC0gQ2xhc3NlL3JvbGUsIEhQLCBhdHJpYnV0b3MgZSBpbnZlbnTDoXJpbyB0YW1iw6ltIERFVkVNIHNlciBpbmZlcmlkb3MgYSBwYXJ0aXIgZG8gYmFja3N0b3J5LlxuICAtIFJlc3BlaXRlIGVzdHJpdGFtZW50ZSBhcyBjbGFzc2VzL3JvbGVzIHBlcm1pdGlkYXMgcGFyYSBvIHNpc3RlbWEuXG4gIC0gU2UgbyB0ZXh0byBlc3RpdmVyIGdlbsOpcmljbywgSU5GRVJJUiB2YWxvcmVzIHBsYXVzw612ZWlzIGNvbSBiYXNlIG5vIGfDqm5lcm8gZSBzaXN0ZW1hLlxuICAtIFNlIG8gYmFja3N0b3J5IGZvciByYXNvLCB1c2UgdG90YWwgY3JpYXRpdmlkYWRlIHBhcmEgcHJlZW5jaGVyIHR1ZG8gY29tIGNvZXLDqm5jaWEuXG4gIC0gTnVuY2EgZGVpeGUgYXRyaWJ1dG9zIHZhemlvczsgc2UgZmFsdGFyLCBwcmVlbmNoYSBjb20gdmFsb3JlcyBwYWRyw6NvIGNvZXJlbnRlcy5cbiAgLSBSZXNwb25kYSBBUEVOQVMgY29tIHVtIEpTT04gdsOhbGlkbyAoc2VtIG1hcmtkb3duLCBzZW0gZXhwbGljYcOnw7VlcykuXG5cblJlc3BvbmRhIEFQRU5BUyBjb20gdW0gSlNPTiB2w6FsaWRvIGUgY29uY2lzbywgc2VtIE1hcmtkb3duLmA7XG5cbiAgICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXTtcblxuICAgIGNvbnN0IGdlbmVyYXRlID0gYXN5bmMgKGV4dHJhOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IHByb21wdCA9IGAke3Byb21wdEJhc2V9XFxuXFxuJHtleHRyYX1gLnRyaW0oKTtcbiAgICAgIHJldHVybiB3aXRoTW9kZWxGYWxsYmFjayhcbiAgICAgICAgKG1vZGVsKSA9PlxuICAgICAgICAgIGFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgICAgICAgIG1vZGVsLFxuICAgICAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6ICd1c2VyJywgY29udGVudDogcHJvbXB0IH1dLFxuICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNixcbiAgICAgICAgICB9KSxcbiAgICAgICAgeyBrZXk6IGBpbmZlcjoke3N5c3RlbU5hbWV9YCB9XG4gICAgICApO1xuICAgIH07XG5cbiAgICBjb25zdCBhdHRlbXB0cyA9IFtcbiAgICAgICdHZXJlIHZhbG9yZXMgY29tcGxldG9zIGUgY29lcmVudGVzLicsXG4gICAgICAnU2UgYWxnbyBlc3RpdmVyIGZhbHRhbmRvLCBjb21wbGV0ZSBjb20gdmFsb3JlcyBwYWRyw6NvIGRvIHNpc3RlbWEuJyxcbiAgICAgICdSZWVudmllIHVtIEpTT04gdsOhbGlkbyBjb20gdG9kb3Mgb3MgY2FtcG9zIG9icmlnYXTDs3Jpb3MgcHJlZW5jaGlkb3MuJyxcbiAgICBdO1xuXG4gICAgbGV0IHBhcnNlZEpzb246IGFueSA9IG51bGw7XG4gICAgbGV0IHBhcnNlZE9iajogYW55ID0gbnVsbDtcblxuICAgIGZvciAoY29uc3QgZXh0cmEgb2YgYXR0ZW1wdHMpIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdlbmVyYXRlKGV4dHJhKTtcbiAgICAgIGNvbnN0IHJhdyA9IHJlc3VsdC5jaG9pY2VzPy5bMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgJyc7XG4gICAgICBjb25zdCBqc29uTWF0Y2ggPSByYXcubWF0Y2goL1xce1tcXHNcXFNdKlxcfS8pO1xuICAgICAgaWYgKCFqc29uTWF0Y2gpIGNvbnRpbnVlO1xuICAgICAgdHJ5IHtcbiAgICAgICAgcGFyc2VkSnNvbiA9IEpTT04ucGFyc2UoanNvbk1hdGNoWzBdKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjb25zdCBjYW5kaWRhdGUgPSBjaGFyYWN0ZXJTY2hlbWEuc2FmZVBhcnNlKHBhcnNlZEpzb24pO1xuICAgICAgaWYgKGNhbmRpZGF0ZS5zdWNjZXNzKSB7XG4gICAgICAgIHBhcnNlZE9iaiA9IGNhbmRpZGF0ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFwYXJzZWRPYmo/LnN1Y2Nlc3MpIHtcbiAgICAgIHdhcm5pbmdzLnB1c2goJ0ZpY2hhIGluY29tcGxldGEuIE7Do28gZm9pIHBvc3PDrXZlbCBjb25jbHVpci4nKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGNoYXJhY3RlcjogcGFyc2VkSnNvbiB8fCB7fSwgd2FybmluZ3MgfSk7XG4gICAgfVxuXG4gICAgY29uc3Qgb2JqID0gcGFyc2VkT2JqLmRhdGEgYXMgYW55O1xuXG4gICAgY29uc3Qgbm9ybWFsaXplU3RyaW5nID0gKHZhbHVlOiBhbnkpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSByZXR1cm4gdmFsdWUudHJpbSgpO1xuICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybiAnJztcbiAgICAgIHJldHVybiBTdHJpbmcodmFsdWUpLnRyaW0oKTtcbiAgICB9O1xuXG4gICAgY29uc3QgY29lcmNlTnVtYmVyID0gKHZhbHVlOiBhbnkpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIE51bWJlci5pc0Zpbml0ZSh2YWx1ZSkpIHJldHVybiB2YWx1ZTtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGNvbnN0IHBhcnNlZCA9IE51bWJlcih2YWx1ZS5yZXBsYWNlKCcsJywgJy4nKSk7XG4gICAgICAgIHJldHVybiBOdW1iZXIuaXNGaW5pdGUocGFyc2VkKSA/IHBhcnNlZCA6IG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuXG4gICAgY29uc3QgY2xhbXAgPSAodmFsdWU6IG51bWJlciwgbWluOiBudW1iZXIsIG1heDogbnVtYmVyKSA9PiBNYXRoLm1pbihtYXgsIE1hdGgubWF4KG1pbiwgdmFsdWUpKTtcblxuICAgIGNvbnN0IHJhbmRvbUluUmFuZ2UgPSAobWluOiBudW1iZXIsIG1heDogbnVtYmVyLCBzdGVwID0gMSkgPT4ge1xuICAgICAgY29uc3Qgc3RlcHMgPSBNYXRoLmZsb29yKChtYXggLSBtaW4pIC8gc3RlcCkgKyAxO1xuICAgICAgcmV0dXJuIG1pbiArIHN0ZXAgKiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzdGVwcyk7XG4gICAgfTtcblxuICAgIGNvbnN0IHBpY2tCYXNlID0gKHZhbHVlczogbnVtYmVyW10sIGNvdW50OiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IHNodWZmbGVkID0gWy4uLnZhbHVlc10uc29ydCgoKSA9PiBNYXRoLnJhbmRvbSgpIC0gMC41KTtcbiAgICAgIHJldHVybiBzaHVmZmxlZC5zbGljZSgwLCBjb3VudCk7XG4gICAgfTtcblxuICAgIGNvbnN0IG5vcm1hbGl6ZUF0dHJpYnV0ZXMgPSAoXG4gICAgICBhdHRyczogUmVjb3JkPHN0cmluZywgYW55PiB8IHVuZGVmaW5lZCxcbiAgICAgIGtleXM6IHN0cmluZ1tdLFxuICAgICAgbWluOiBudW1iZXIsXG4gICAgICBtYXg6IG51bWJlcixcbiAgICAgIGJhc2VWYWx1ZXM/OiBudW1iZXJbXVxuICAgICkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0geyAuLi4oYXR0cnMgfHwge30pIH07XG4gICAgICBjb25zdCBiYXNlID0gYmFzZVZhbHVlcyA/IHBpY2tCYXNlKGJhc2VWYWx1ZXMsIGtleXMubGVuZ3RoKSA6IFtdO1xuICAgICAga2V5cy5mb3JFYWNoKChrZXksIGluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IHJhdyA9IHJlc3VsdFtrZXldID8/IHJlc3VsdFtrZXkudG9Mb3dlckNhc2UoKV07XG4gICAgICAgIGNvbnN0IGNvZXJjZWQgPSBjb2VyY2VOdW1iZXIocmF3KTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBjb2VyY2VkID09PSBudWxsXG4gICAgICAgICAgPyAoYmFzZVZhbHVlcyA/IGJhc2VbaW5kZXhdIDogcmFuZG9tSW5SYW5nZShtaW4sIG1heCkpXG4gICAgICAgICAgOiBjb2VyY2VkO1xuICAgICAgICByZXN1bHRba2V5XSA9IGNsYW1wKHZhbHVlLCBtaW4sIG1heCk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIGNvbnN0IG5vcm1hbGl6ZVNraWxscyA9ICh2YWx1ZTogYW55KSA9PiB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlLm1hcCgodikgPT4gU3RyaW5nKHYpKS5tYXAoKHYpID0+IHYudHJpbSgpKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gdmFsdWUuc3BsaXQoJywnKS5tYXAoKHMpID0+IHMudHJpbSgpKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgICB9XG4gICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModmFsdWUpLm1hcCgocykgPT4gcy50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBbXSBhcyBzdHJpbmdbXTtcbiAgICB9O1xuXG4gICAgY29uc3Qgbm9ybWFsaXplSW52ZW50b3J5ID0gKHZhbHVlOiBhbnkpID0+IHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gdmFsdWUubWFwKCh2KSA9PiBTdHJpbmcodikpLm1hcCgodikgPT4gdi50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZS5zcGxpdCgnLCcpLm1hcCgocykgPT4gcy50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBbXSBhcyBzdHJpbmdbXTtcbiAgICB9O1xuXG4gICAgY29uc3Qgbm9ybWFsaXplQ2xhc3MgPSAodmFsdWU6IGFueSkgPT4ge1xuICAgICAgY29uc3QgcmF3ID0gbm9ybWFsaXplU3RyaW5nKHZhbHVlKTtcbiAgICAgIGlmICghY2xhc3NPcHRpb25zLmxlbmd0aCB8fCBub3JtYWxpemVkU3lzdGVtID09PSAnTmFycmF0aXZvJykge1xuICAgICAgICByZXR1cm4gcmF3IHx8IChjbGFzc09wdGlvbnNbMF0gfHwgJ0F2ZW50dXJlaXJvJyk7XG4gICAgICB9XG4gICAgICBjb25zdCBtYXRjaCA9IGNsYXNzT3B0aW9ucy5maW5kKChjKSA9PiBjLnRvTG93ZXJDYXNlKCkgPT09IHJhdy50b0xvd2VyQ2FzZSgpKTtcbiAgICAgIGlmIChtYXRjaCkgcmV0dXJuIG1hdGNoO1xuICAgICAgY29uc3QgZnV6enkgPSBjbGFzc09wdGlvbnMuZmluZCgoYykgPT4gcmF3ICYmIGMudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhyYXcudG9Mb3dlckNhc2UoKSkpO1xuICAgICAgcmV0dXJuIGZ1enp5IHx8IGNsYXNzT3B0aW9uc1swXTtcbiAgICB9O1xuXG4gICAgY29uc3QgcGlja1NraWxscyA9IChzb3VyY2U6IHN0cmluZ1tdLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpID0+IHtcbiAgICAgIGlmIChzb3VyY2UubGVuZ3RoID09PSAwKSByZXR1cm4gW10gYXMgc3RyaW5nW107XG4gICAgICBjb25zdCBjb3VudCA9IE1hdGgubWF4KG1pbiwgTWF0aC5taW4obWF4LCBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluKSk7XG4gICAgICBjb25zdCBzaHVmZmxlZCA9IFsuLi5zb3VyY2VdLnNvcnQoKCkgPT4gTWF0aC5yYW5kb20oKSAtIDAuNSk7XG4gICAgICByZXR1cm4gc2h1ZmZsZWQuc2xpY2UoMCwgTWF0aC5taW4oY291bnQsIHNodWZmbGVkLmxlbmd0aCkpO1xuICAgIH07XG5cbiAgICBjb25zdCBsaW1pdFNraWxscyA9IChza2lsbHM6IHN0cmluZ1tdLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpID0+IHtcbiAgICAgIGlmIChza2lsbHMubGVuZ3RoIDw9IG1heCkgcmV0dXJuIHNraWxscztcbiAgICAgIGNvbnN0IHNodWZmbGVkID0gWy4uLnNraWxsc10uc29ydCgoKSA9PiBNYXRoLnJhbmRvbSgpIC0gMC41KTtcbiAgICAgIGNvbnN0IGNvdW50ID0gTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIHNodWZmbGVkLmxlbmd0aCkpO1xuICAgICAgcmV0dXJuIHNodWZmbGVkLnNsaWNlKDAsIGNvdW50KTtcbiAgICB9O1xuXG4gICAgY29uc3QgZW5zdXJlTnVtYmVyID0gKHZhbHVlOiBhbnksIGxhYmVsOiBzdHJpbmcsIG1pbj86IG51bWJlciwgbWF4PzogbnVtYmVyKSA9PiB7XG4gICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnbnVtYmVyJyB8fCBOdW1iZXIuaXNOYU4odmFsdWUpKSB7XG4gICAgICAgIHdhcm5pbmdzLnB1c2goYCR7bGFiZWx9IGludsOhbGlkb2ApO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAobWluICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgPCBtaW4pIHdhcm5pbmdzLnB1c2goYCR7bGFiZWx9IGFiYWl4byBkbyBtw61uaW1vICgke21pbn0pYCk7XG4gICAgICBpZiAobWF4ICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgPiBtYXgpIHdhcm5pbmdzLnB1c2goYCR7bGFiZWx9IGFjaW1hIGRvIG3DoXhpbW8gKCR7bWF4fSlgKTtcbiAgICB9O1xuXG4gICAgY29uc3QgZW5zdXJlQXR0cmlidXRlc1JhbmdlID0gKGtleXM6IHN0cmluZ1tdLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpID0+IHtcbiAgICAgIGlmICghb2JqLmF0dHJpYnV0ZXMgfHwgdHlwZW9mIG9iai5hdHRyaWJ1dGVzICE9PSAnb2JqZWN0Jykge1xuICAgICAgICB3YXJuaW5ncy5wdXNoKCdBdHJpYnV0b3MgaW52w6FsaWRvcycpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBrZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IG9iai5hdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIGVuc3VyZU51bWJlcih2YWx1ZSwgYEF0cmlidXRvICR7a2V5fWAsIG1pbiwgbWF4KTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBpZiAobm9ybWFsaXplZFN5c3RlbSA9PT0gJ0QmRCA1ZScpIHtcbiAgICAgIG9iai5hdHRyaWJ1dGVzID0gbm9ybWFsaXplQXR0cmlidXRlcyhcbiAgICAgICAgb2JqLmF0dHJpYnV0ZXMsXG4gICAgICAgIFsnZm9yw6dhJywgJ2Rlc3RyZXphJywgJ2NvbnN0aXR1acOnw6NvJywgJ2ludGVsaWfDqm5jaWEnLCAnc2FiZWRvcmlhJywgJ2NhcmlzbWEnXSxcbiAgICAgICAgMSxcbiAgICAgICAgMjAsXG4gICAgICAgIFsxNSwgMTQsIDEzLCAxMiwgMTAsIDhdXG4gICAgICApO1xuICAgICAgZW5zdXJlQXR0cmlidXRlc1JhbmdlKFxuICAgICAgICBbJ2ZvcsOnYScsICdkZXN0cmV6YScsICdjb25zdGl0dWnDp8OjbycsICdpbnRlbGlnw6puY2lhJywgJ3NhYmVkb3JpYScsICdjYXJpc21hJ10sXG4gICAgICAgIDEsXG4gICAgICAgIDIwXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChub3JtYWxpemVkU3lzdGVtID09PSAnT3JkZW0gUGFyYW5vcm1hbCcpIHtcbiAgICAgIG9iai5hdHRyaWJ1dGVzID0gbm9ybWFsaXplQXR0cmlidXRlcyhcbiAgICAgICAgb2JqLmF0dHJpYnV0ZXMsXG4gICAgICAgIFsnZm9yw6dhJywgJ2FnaWxpZGFkZScsICdpbnRlbGVjdG8nLCAncHJlc2Vuw6dhJywgJ3ZpZ29yJ10sXG4gICAgICAgIDEsXG4gICAgICAgIDUsXG4gICAgICAgIFs0LCAzLCAzLCAyLCAyXVxuICAgICAgKTtcbiAgICAgIGVuc3VyZUF0dHJpYnV0ZXNSYW5nZShbJ2ZvcsOnYScsICdhZ2lsaWRhZGUnLCAnaW50ZWxlY3RvJywgJ3ByZXNlbsOnYScsICd2aWdvciddLCAxLCA1KTtcbiAgICB9XG5cbiAgICBpZiAobm9ybWFsaXplZFN5c3RlbSA9PT0gJ0NhbGwgb2YgQ3RodWxodScpIHtcbiAgICAgIG9iai5hdHRyaWJ1dGVzID0gbm9ybWFsaXplQXR0cmlidXRlcyhcbiAgICAgICAgb2JqLmF0dHJpYnV0ZXMsXG4gICAgICAgIFsnZm9yw6dhJywgJ2NvbnN0aXR1acOnw6NvJywgJ2Rlc3RyZXphJywgJ2ludGVsaWfDqm5jaWEnLCAncG9kZXInLCAnYXBhcsOqbmNpYScsICdlZHVjYcOnw6NvJywgJ3RhbWFuaG8nXSxcbiAgICAgICAgMSxcbiAgICAgICAgMTAwLFxuICAgICAgICBbNzAsIDYwLCA2MCwgNTAsIDUwLCA0MCwgNDAsIDMwXVxuICAgICAgKTtcbiAgICAgIGVuc3VyZU51bWJlcihvYmouc2FuaXR5LCAnU0FOJywgMCwgOTkpO1xuICAgICAgZW5zdXJlTnVtYmVyKG9iai5sdWNrLCAnTHVjaycsIDAsIDk5KTtcbiAgICAgIGVuc3VyZUF0dHJpYnV0ZXNSYW5nZShcbiAgICAgICAgWydmb3LDp2EnLCAnY29uc3RpdHVpw6fDo28nLCAnZGVzdHJlemEnLCAnaW50ZWxpZ8OqbmNpYScsICdwb2RlcicsICdhcGFyw6puY2lhJywgJ2VkdWNhw6fDo28nLCAndGFtYW5obyddLFxuICAgICAgICAxLFxuICAgICAgICAxMDBcbiAgICAgICk7XG4gICAgfVxuXG4gICAgb2JqLmNsYXNzX29yX3JvbGUgPSBub3JtYWxpemVDbGFzcyhvYmouY2xhc3Nfb3Jfcm9sZSk7XG4gICAgb2JqLnByb2Zlc3Npb24gPSBub3JtYWxpemVTdHJpbmcob2JqLnByb2Zlc3Npb24gfHwgcHJvZmVzc2lvbik7XG5cbiAgICBjb25zdCBub3JtYWxpemVkU2tpbGxzID0gbm9ybWFsaXplU2tpbGxzKG9iai5za2lsbHMpO1xuICAgIGlmIChub3JtYWxpemVkU2tpbGxzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc3QgZGVmYXVsdHMgPSBwaWNrU2tpbGxzKFxuICAgICAgICBza2lsbHNSZWZlcmVuY2UsXG4gICAgICAgIG5vcm1hbGl6ZWRTeXN0ZW0gPT09ICdDYWxsIG9mIEN0aHVsaHUnID8gNSA6IDQsXG4gICAgICAgIG5vcm1hbGl6ZWRTeXN0ZW0gPT09ICdPcmRlbSBQYXJhbm9ybWFsJyA/IDYgOiA1XG4gICAgICApO1xuICAgICAgb2JqLnNraWxscyA9IGRlZmF1bHRzO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBmaWx0ZXJlZCA9IHNraWxsc1JlZmVyZW5jZS5sZW5ndGhcbiAgICAgICAgPyBub3JtYWxpemVkU2tpbGxzLmZpbHRlcigocykgPT4gc2tpbGxzUmVmZXJlbmNlLnNvbWUoKHJlZikgPT4gcmVmLnRvTG93ZXJDYXNlKCkgPT09IHMudG9Mb3dlckNhc2UoKSkpXG4gICAgICAgIDogbm9ybWFsaXplZFNraWxscztcbiAgICAgIGNvbnN0IGJhc2UgPSBmaWx0ZXJlZC5sZW5ndGggPiAwID8gZmlsdGVyZWQgOiBub3JtYWxpemVkU2tpbGxzO1xuICAgICAgY29uc3QgbGltaXRlZCA9IGxpbWl0U2tpbGxzKFxuICAgICAgICBiYXNlLFxuICAgICAgICBub3JtYWxpemVkU3lzdGVtID09PSAnQ2FsbCBvZiBDdGh1bGh1JyA/IDYgOiA0LFxuICAgICAgICBub3JtYWxpemVkU3lzdGVtID09PSAnT3JkZW0gUGFyYW5vcm1hbCcgPyA3IDogNlxuICAgICAgKTtcbiAgICAgIG9iai5za2lsbHMgPSBsaW1pdGVkO1xuICAgIH1cblxuICAgIG9iai5pbnZlbnRvcnkgPSBub3JtYWxpemVJbnZlbnRvcnkob2JqLmludmVudG9yeSk7XG4gICAgb2JqLmhwID0gY29lcmNlTnVtYmVyKG9iai5ocCkgPz8gb2JqLmhwO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgY2hhcmFjdGVyOiBvYmosIHdhcm5pbmdzIH0pO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcignQ2hhcmFjdGVyIGluZmVyZW5jZSBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdTZXJ2ZXIgZXJyb3InIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJHcm9xIiwieiIsInBpY2tBcGlLZXkiLCJSUEdfU1lTVEVNUyIsIm5vcm1hbGl6ZVN5c3RlbU5hbWUiLCJTS0lMTFNfQllfU1lTVEVNIiwiQ0xBU1NFU19CWV9TWVNURU0iLCJpc1JhdGVMaW1pdGVkIiwid2l0aE1vZGVsRmFsbGJhY2siLCJib2R5U2NoZW1hIiwib2JqZWN0Iiwic3lzdGVtTmFtZSIsInN0cmluZyIsIm5hbWUiLCJhcHBlYXJhbmNlIiwiYmFja3N0b3J5IiwicHJvZmVzc2lvbiIsIm9wdGlvbmFsIiwiY2hhcmFjdGVyU2NoZW1hIiwiY2xhc3Nfb3Jfcm9sZSIsImF0dHJpYnV0ZXMiLCJyZWNvcmQiLCJudW1iZXIiLCJza2lsbHMiLCJ1bmlvbiIsImFycmF5IiwiYW55IiwiaHAiLCJpbnZlbnRvcnkiLCJub3RlcyIsInNhbml0eSIsImx1Y2siLCJodW1hbml0eSIsImJsb29kX3Bvb2wiLCJlbXAiLCJyZXB1dGF0aW9uIiwibWFuYSIsInN0YW1pbmEiLCJmb2N1cyIsImFsaWdubWVudCIsImZvcmNlX3NlbnNpdGl2ZSIsImJvb2xlYW4iLCJmb3JjZV9yYXRpbmciLCJncml0IiwiY29ycnVwdGlvbiIsIlBPU1QiLCJyZXEiLCJ1c2VyS2V5IiwiaGVhZGVycyIsImdldCIsInVuZGVmaW5lZCIsImlwIiwic3BsaXQiLCJ0cmltIiwicmF0ZUtleSIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInBhcnNlZCIsInNhZmVQYXJzZSIsInN1Y2Nlc3MiLCJkYXRhIiwibm9ybWFsaXplZFN5c3RlbSIsInJ1bGVzIiwic2tpbGxzUmVmZXJlbmNlIiwiY2xhc3NPcHRpb25zIiwiYXBpS2V5IiwiYWkiLCJzeXN0ZW1IaW50IiwicHJvbXB0QmFzZSIsIm1hcCIsInMiLCJqb2luIiwiYyIsIndhcm5pbmdzIiwiZ2VuZXJhdGUiLCJleHRyYSIsInByb21wdCIsIm1vZGVsIiwiY2hhdCIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibWVzc2FnZXMiLCJyb2xlIiwiY29udGVudCIsInRlbXBlcmF0dXJlIiwia2V5IiwiYXR0ZW1wdHMiLCJwYXJzZWRKc29uIiwicGFyc2VkT2JqIiwicmVzdWx0IiwicmF3IiwiY2hvaWNlcyIsIm1lc3NhZ2UiLCJqc29uTWF0Y2giLCJtYXRjaCIsIkpTT04iLCJwYXJzZSIsImUiLCJjYW5kaWRhdGUiLCJwdXNoIiwiY2hhcmFjdGVyIiwib2JqIiwibm9ybWFsaXplU3RyaW5nIiwidmFsdWUiLCJTdHJpbmciLCJjb2VyY2VOdW1iZXIiLCJOdW1iZXIiLCJpc0Zpbml0ZSIsInJlcGxhY2UiLCJjbGFtcCIsIm1pbiIsIm1heCIsIk1hdGgiLCJyYW5kb21JblJhbmdlIiwic3RlcCIsInN0ZXBzIiwiZmxvb3IiLCJyYW5kb20iLCJwaWNrQmFzZSIsInZhbHVlcyIsImNvdW50Iiwic2h1ZmZsZWQiLCJzb3J0Iiwic2xpY2UiLCJub3JtYWxpemVBdHRyaWJ1dGVzIiwiYXR0cnMiLCJrZXlzIiwiYmFzZVZhbHVlcyIsImJhc2UiLCJsZW5ndGgiLCJmb3JFYWNoIiwiaW5kZXgiLCJ0b0xvd2VyQ2FzZSIsImNvZXJjZWQiLCJub3JtYWxpemVTa2lsbHMiLCJBcnJheSIsImlzQXJyYXkiLCJ2IiwiZmlsdGVyIiwiQm9vbGVhbiIsIk9iamVjdCIsIm5vcm1hbGl6ZUludmVudG9yeSIsIm5vcm1hbGl6ZUNsYXNzIiwiZmluZCIsImZ1enp5IiwiaW5jbHVkZXMiLCJwaWNrU2tpbGxzIiwic291cmNlIiwibGltaXRTa2lsbHMiLCJlbnN1cmVOdW1iZXIiLCJsYWJlbCIsImlzTmFOIiwiZW5zdXJlQXR0cmlidXRlc1JhbmdlIiwibm9ybWFsaXplZFNraWxscyIsImRlZmF1bHRzIiwiZmlsdGVyZWQiLCJzb21lIiwicmVmIiwibGltaXRlZCIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/character-infer/route.ts\n");

/***/ }),

/***/ "(rsc)/./constants.ts":
/*!**********************!*\
  !*** ./constants.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CLASSES_BY_SYSTEM: () => (/* binding */ CLASSES_BY_SYSTEM),\n/* harmony export */   INITIAL_SYSTEM_PROMPT_TEMPLATE: () => (/* binding */ INITIAL_SYSTEM_PROMPT_TEMPLATE),\n/* harmony export */   RPG_SYSTEMS: () => (/* binding */ RPG_SYSTEMS),\n/* harmony export */   SKILLS_BY_SYSTEM: () => (/* binding */ SKILLS_BY_SYSTEM),\n/* harmony export */   SUPPORTED_SYSTEMS: () => (/* binding */ SUPPORTED_SYSTEMS),\n/* harmony export */   normalizeSystemName: () => (/* binding */ normalizeSystemName)\n/* harmony export */ });\nconst RPG_SYSTEMS = {\n    \"Narrativo\": `\n    - Sistema Genérico Baseado em Narrativa (Foco em História).\n    - Rolagens: d20 Simples. 10+ Sucesso, 15+ Sucesso Bom, 20 Sucesso Crítico.\n    - Priorize a regra do legal (Rule of Cool).\n  `,\n    \"D&D 5e\": `\n    - Sistema: Dungeons & Dragons 5th Edition.\n    - Rolagens: d20 + Modificador vs Classe de Dificuldade (CD).\n    - Atributos: Força, Destreza, Constituição, Inteligência, Sabedoria, Carisma.\n    - REGRAS CRÍTICAS: Testes de Percepção (Sabedoria) para ouvir/notar, Investigação (Inteligência) para procurar, Furtividade (Destreza) para esconder.\n  `,\n    \"Ordem Paranormal\": `\n    - Sistema: Ordem Paranormal RPG.\n    - Atributos principais: Força, Agilidade, Intelecto, Presença, Vigor.\n    - Ações e testes usam d20 + atributo.\n    - Horror Investigativo. O Paranormal não vem para nossa realidade de forma fácil.\n  `,\n    \"Call of Cthulhu\": `\n    - Sistema: Baseado em BRP (d100).\n    - Atributos: Força, Constituição, Destreza, Inteligência, Poder, Aparência, Educação, Tamanho.\n    - Testes usam percentuais; sucesso com resultado <= atributo.\n    - Foco em Horror Cósmico, Investigação e Loucura.\n    - Combate é mortal e deve ser evitado.\n  `\n};\nconst SUPPORTED_SYSTEMS = [\n    \"Narrativo\",\n    \"D&D 5e\",\n    \"Ordem Paranormal\",\n    \"Call of Cthulhu\"\n];\nfunction normalizeSystemName(systemName) {\n    if (systemName && SUPPORTED_SYSTEMS.includes(systemName)) {\n        return systemName;\n    }\n    return \"Narrativo\";\n}\nconst SKILLS_BY_SYSTEM = {\n    \"Narrativo\": [\n        \"Atletismo\",\n        \"Furtividade\",\n        \"Percep\\xe7\\xe3o\",\n        \"Investiga\\xe7\\xe3o\",\n        \"Persuas\\xe3o\",\n        \"Intimida\\xe7\\xe3o\",\n        \"Engana\\xe7\\xe3o\",\n        \"Sobreviv\\xeancia\",\n        \"Medicina\",\n        \"Conhecimento\"\n    ],\n    \"D&D 5e\": [\n        \"Acrobatics (Acrobacia)\",\n        \"Animal Handling (Adestrar Animais)\",\n        \"Arcana (Arcano)\",\n        \"Athletics (Atletismo)\",\n        \"Deception (Engana\\xe7\\xe3o)\",\n        \"History (Hist\\xf3ria)\",\n        \"Insight (Intui\\xe7\\xe3o)\",\n        \"Intimidation (Intimida\\xe7\\xe3o)\",\n        \"Investigation (Investiga\\xe7\\xe3o)\",\n        \"Medicine (Medicina)\",\n        \"Nature (Natureza)\",\n        \"Perception (Percep\\xe7\\xe3o)\",\n        \"Performance (Atua\\xe7\\xe3o)\",\n        \"Persuasion (Persuas\\xe3o)\",\n        \"Religion (Religi\\xe3o)\",\n        \"Sleight of Hand (Prestidigita\\xe7\\xe3o)\",\n        \"Stealth (Furtividade)\",\n        \"Survival (Sobreviv\\xeancia)\"\n    ],\n    \"Ordem Paranormal\": [\n        \"Acrobacia\",\n        \"Adestramento\",\n        \"Artes\",\n        \"Atletismo\",\n        \"Atualidades\",\n        \"Engana\\xe7\\xe3o\",\n        \"Fortitude\",\n        \"Furtividade\",\n        \"Iniciativa\",\n        \"Intimida\\xe7\\xe3o\",\n        \"Investiga\\xe7\\xe3o\",\n        \"Intui\\xe7\\xe3o\",\n        \"Luta\",\n        \"Medicina\",\n        \"Ocultismo\",\n        \"Percep\\xe7\\xe3o\",\n        \"Persuas\\xe3o\",\n        \"Pilotagem\",\n        \"Pontaria\",\n        \"Reflexos\",\n        \"Tecnologia\",\n        \"Vontade\"\n    ],\n    \"Call of Cthulhu\": [\n        \"Accounting (Contabilidade)\",\n        \"Anthropology (Antropologia)\",\n        \"Archaeology (Arqueologia)\",\n        \"Art/Craft (Arte/Of\\xedcio)\",\n        \"Charm (L\\xe1bia)\",\n        \"Climb (Escalar)\",\n        \"Credit Rating (Cr\\xe9dito)\",\n        \"Disguise (Disfarce)\",\n        \"Dodge (Esquiva)\",\n        \"Drive Auto (Dirigir)\",\n        \"Fast Talk (L\\xe1bia R\\xe1pida)\",\n        \"First Aid (Primeiros Socorros)\",\n        \"History (Hist\\xf3ria)\",\n        \"Intimidate (Intimida\\xe7\\xe3o)\",\n        \"Jump (Saltar)\",\n        \"Law (Direito)\",\n        \"Library Use (Biblioteca)\",\n        \"Listen (Escutar)\",\n        \"Locksmith (Arrombamento)\",\n        \"Medicine (Medicina)\",\n        \"Natural World (Mundo Natural)\",\n        \"Occult (Ocultismo)\",\n        \"Operate Heavy Machinery (M\\xe1quinas Pesadas)\",\n        \"Persuade (Persuas\\xe3o)\",\n        \"Psychology (Psicologia)\",\n        \"Science (Ci\\xeancia)\",\n        \"Spot Hidden (Notar)\",\n        \"Stealth (Furtividade)\",\n        \"Survival (Sobreviv\\xeancia)\",\n        \"Swim (Nata\\xe7\\xe3o)\",\n        \"Throw (Arremesso)\",\n        \"Track (Rastrear)\"\n    ]\n};\nconst CLASSES_BY_SYSTEM = {\n    \"Narrativo\": [\n        \"Aventureiro\",\n        \"Explorador\",\n        \"Sobrevivente\",\n        \"Erudito\",\n        \"Mercen\\xe1rio\"\n    ],\n    \"D&D 5e\": [\n        \"B\\xe1rbaro\",\n        \"Bardo\",\n        \"Bruxo\",\n        \"Cl\\xe9rigo\",\n        \"Druida\",\n        \"Feiticeiro\",\n        \"Guerreiro\",\n        \"Ladino\",\n        \"Mago\",\n        \"Monge\",\n        \"Paladino\",\n        \"Patrulheiro\",\n        \"Art\\xedfice\"\n    ],\n    \"Ordem Paranormal\": [\n        \"Combatente\",\n        \"Ocultista\",\n        \"Especialista\",\n        \"Sobrevivente\"\n    ],\n    \"Call of Cthulhu\": [\n        \"Investigador\",\n        \"Antrop\\xf3logo\",\n        \"Arque\\xf3logo\",\n        \"Artista\",\n        \"Detetive\",\n        \"Jornalista\",\n        \"M\\xe9dico\",\n        \"Professor\",\n        \"Criminoso\",\n        \"Diletante\",\n        \"Engenheiro\",\n        \"Explorador\",\n        \"Historiador\",\n        \"Linguista\",\n        \"Militar\",\n        \"Policial\",\n        \"Psic\\xf3logo\",\n        \"Rep\\xf3rter\",\n        \"Pesquisador\"\n    ]\n};\nconst INITIAL_SYSTEM_PROMPT_TEMPLATE = `\n# PROTOCOLO MESTRE SUPREMO (v2.0 - Strict Rules)\n## 1. Persona e Missão\nVocê é o Mestre Supremo (Game Master), narrador experiente.\nIdioma: SEMPRE Português do Brasil.\nObjetivo: Guiar uma aventura imersiva com mecânicas sólidas.\n\n## 2. CONTEXTO\n**Mundo:** {{WORLD_HISTORY}}\n**Personagem:** {{CHAR_NAME}}, {{CHAR_APPEARANCE}}.\n**Background:** {{CHAR_BACKSTORY}}\n**Sistema:** {{SYSTEM_NAME}}\n**Regras:** {{SYSTEM_RULES}}\n\n## 3. Gestão de Estado & REGRAS DE DADOS (CRÍTICO)\n- **REGRA DE OURO DAS ROLAGENS:** NÃO assuma o sucesso ou fracasso de ações incertas.\n- **INICIATIVA SEM ROLAGEM:** A iniciativa é sempre determinada pelo MAIOR atributo de destreza (ou equivalente do sistema, ex: agilidade/reflexos). Não peça rolagem para iniciativa.\n- Se o jogador disser \"Eu tento ouvir\", \"Eu procuro por armadilhas\", \"Eu ataco\", \"Eu minto\", \"Eu escalo\":\n  1. **PARE A NARRATIVA IMEDIATAMENTE.**\n  2. Chame a Tool \"request_roll\" com o atributo apropriado (ex: Perception, Investigation, Athletics).\n  3. Só continue a narrativa após receber o resultado.\n- Use Tool \"generate_image\" APENAS em: Início da Aventura, Bosses, Locais Épicos.\n- Use Tool \"trigger_game_over\" se PV = 0 ou morte narrativa óbvia.\n\n## 4. Consistência Visual\nEstilo: \"{{VISUAL_STYLE}}\". Use este estilo nos prompts de imagem.\n\n## 5. Fluxo de Turno\n1. Se for uma resposta a uma rolagem, narre o resultado (Sucesso ou Falha) dramaticamente.\n2. Narre a reação do mundo.\n3. No final de CADA mensagem, adicione uma lista de 3 a 5 sugestões.\n   \n   Formato Obrigatório de Sugestões:\n   ### Sugestões:\n   - A) [Ação Sugerida 1]\n   - B) [Ação Sugerida 2]\n   - C) [Ação Sugerida 3]\n\n## 6. Formatação\n- Use Markdown rico.\n- Negrito para NPCs ou Itens.\n- *Itálico* para sons e pensamentos.\n- Quebras de linha duplas para legibilidade.\n`;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9jb25zdGFudHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQU8sTUFBTUEsY0FBc0M7SUFDakQsYUFBYSxDQUFDOzs7O0VBSWQsQ0FBQztJQUNELFVBQVUsQ0FBQzs7Ozs7RUFLWCxDQUFDO0lBQ0Qsb0JBQW9CLENBQUM7Ozs7O0VBS3JCLENBQUM7SUFDRCxtQkFBbUIsQ0FBQzs7Ozs7O0VBTXBCLENBQUM7QUFDSCxFQUFFO0FBRUssTUFBTUMsb0JBQW9CO0lBQUM7SUFBYTtJQUFVO0lBQW9CO0NBQWtCLENBQVU7QUFHbEcsU0FBU0Msb0JBQW9CQyxVQUFtQjtJQUNyRCxJQUFJQSxjQUFjRixrQkFBa0JHLFFBQVEsQ0FBQ0QsYUFBZ0M7UUFDM0UsT0FBT0E7SUFDVDtJQUNBLE9BQU87QUFDVDtBQUVPLE1BQU1FLG1CQUFzRDtJQUNqRSxhQUFhO1FBQ1g7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtJQUNELFVBQVU7UUFDUjtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtJQUNELG9CQUFvQjtRQUNsQjtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtLQUNEO0lBQ0QsbUJBQW1CO1FBQ2pCO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtBQUNILEVBQUU7QUFFSyxNQUFNQyxvQkFBdUQ7SUFDbEUsYUFBYTtRQUNYO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtJQUNELFVBQVU7UUFDUjtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtLQUNEO0lBQ0Qsb0JBQW9CO1FBQ2xCO1FBQ0E7UUFDQTtRQUNBO0tBQ0Q7SUFDRCxtQkFBbUI7UUFDakI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtBQUNILEVBQUU7QUFFSyxNQUFNQyxpQ0FBaUMsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTJDL0MsQ0FBQyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdHJhaS0tLXZpcnR1YWwtdGFibGV0b3AvLi9jb25zdGFudHMudHM/ZGQ0ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgUlBHX1NZU1RFTVM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICdOYXJyYXRpdm8nOiBgXG4gICAgLSBTaXN0ZW1hIEdlbsOpcmljbyBCYXNlYWRvIGVtIE5hcnJhdGl2YSAoRm9jbyBlbSBIaXN0w7NyaWEpLlxuICAgIC0gUm9sYWdlbnM6IGQyMCBTaW1wbGVzLiAxMCsgU3VjZXNzbywgMTUrIFN1Y2Vzc28gQm9tLCAyMCBTdWNlc3NvIENyw610aWNvLlxuICAgIC0gUHJpb3JpemUgYSByZWdyYSBkbyBsZWdhbCAoUnVsZSBvZiBDb29sKS5cbiAgYCxcbiAgJ0QmRCA1ZSc6IGBcbiAgICAtIFNpc3RlbWE6IER1bmdlb25zICYgRHJhZ29ucyA1dGggRWRpdGlvbi5cbiAgICAtIFJvbGFnZW5zOiBkMjAgKyBNb2RpZmljYWRvciB2cyBDbGFzc2UgZGUgRGlmaWN1bGRhZGUgKENEKS5cbiAgICAtIEF0cmlidXRvczogRm9yw6dhLCBEZXN0cmV6YSwgQ29uc3RpdHVpw6fDo28sIEludGVsaWfDqm5jaWEsIFNhYmVkb3JpYSwgQ2FyaXNtYS5cbiAgICAtIFJFR1JBUyBDUsONVElDQVM6IFRlc3RlcyBkZSBQZXJjZXDDp8OjbyAoU2FiZWRvcmlhKSBwYXJhIG91dmlyL25vdGFyLCBJbnZlc3RpZ2HDp8OjbyAoSW50ZWxpZ8OqbmNpYSkgcGFyYSBwcm9jdXJhciwgRnVydGl2aWRhZGUgKERlc3RyZXphKSBwYXJhIGVzY29uZGVyLlxuICBgLFxuICAnT3JkZW0gUGFyYW5vcm1hbCc6IGBcbiAgICAtIFNpc3RlbWE6IE9yZGVtIFBhcmFub3JtYWwgUlBHLlxuICAgIC0gQXRyaWJ1dG9zIHByaW5jaXBhaXM6IEZvcsOnYSwgQWdpbGlkYWRlLCBJbnRlbGVjdG8sIFByZXNlbsOnYSwgVmlnb3IuXG4gICAgLSBBw6fDtWVzIGUgdGVzdGVzIHVzYW0gZDIwICsgYXRyaWJ1dG8uXG4gICAgLSBIb3Jyb3IgSW52ZXN0aWdhdGl2by4gTyBQYXJhbm9ybWFsIG7Do28gdmVtIHBhcmEgbm9zc2EgcmVhbGlkYWRlIGRlIGZvcm1hIGbDoWNpbC5cbiAgYCxcbiAgJ0NhbGwgb2YgQ3RodWxodSc6IGBcbiAgICAtIFNpc3RlbWE6IEJhc2VhZG8gZW0gQlJQIChkMTAwKS5cbiAgICAtIEF0cmlidXRvczogRm9yw6dhLCBDb25zdGl0dWnDp8OjbywgRGVzdHJlemEsIEludGVsaWfDqm5jaWEsIFBvZGVyLCBBcGFyw6puY2lhLCBFZHVjYcOnw6NvLCBUYW1hbmhvLlxuICAgIC0gVGVzdGVzIHVzYW0gcGVyY2VudHVhaXM7IHN1Y2Vzc28gY29tIHJlc3VsdGFkbyA8PSBhdHJpYnV0by5cbiAgICAtIEZvY28gZW0gSG9ycm9yIEPDs3NtaWNvLCBJbnZlc3RpZ2HDp8OjbyBlIExvdWN1cmEuXG4gICAgLSBDb21iYXRlIMOpIG1vcnRhbCBlIGRldmUgc2VyIGV2aXRhZG8uXG4gIGAsXG59O1xuXG5leHBvcnQgY29uc3QgU1VQUE9SVEVEX1NZU1RFTVMgPSBbJ05hcnJhdGl2bycsICdEJkQgNWUnLCAnT3JkZW0gUGFyYW5vcm1hbCcsICdDYWxsIG9mIEN0aHVsaHUnXSBhcyBjb25zdDtcbmV4cG9ydCB0eXBlIFN1cHBvcnRlZFN5c3RlbSA9ICh0eXBlb2YgU1VQUE9SVEVEX1NZU1RFTVMpW251bWJlcl07XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVTeXN0ZW1OYW1lKHN5c3RlbU5hbWU/OiBzdHJpbmcpOiBTdXBwb3J0ZWRTeXN0ZW0ge1xuICBpZiAoc3lzdGVtTmFtZSAmJiBTVVBQT1JURURfU1lTVEVNUy5pbmNsdWRlcyhzeXN0ZW1OYW1lIGFzIFN1cHBvcnRlZFN5c3RlbSkpIHtcbiAgICByZXR1cm4gc3lzdGVtTmFtZSBhcyBTdXBwb3J0ZWRTeXN0ZW07XG4gIH1cbiAgcmV0dXJuICdOYXJyYXRpdm8nO1xufVxuXG5leHBvcnQgY29uc3QgU0tJTExTX0JZX1NZU1RFTTogUmVjb3JkPFN1cHBvcnRlZFN5c3RlbSwgc3RyaW5nW10+ID0ge1xuICAnTmFycmF0aXZvJzogW1xuICAgICdBdGxldGlzbW8nLFxuICAgICdGdXJ0aXZpZGFkZScsXG4gICAgJ1BlcmNlcMOnw6NvJyxcbiAgICAnSW52ZXN0aWdhw6fDo28nLFxuICAgICdQZXJzdWFzw6NvJyxcbiAgICAnSW50aW1pZGHDp8OjbycsXG4gICAgJ0VuZ2FuYcOnw6NvJyxcbiAgICAnU29icmV2aXbDqm5jaWEnLFxuICAgICdNZWRpY2luYScsXG4gICAgJ0NvbmhlY2ltZW50bycsXG4gIF0sXG4gICdEJkQgNWUnOiBbXG4gICAgJ0Fjcm9iYXRpY3MgKEFjcm9iYWNpYSknLFxuICAgICdBbmltYWwgSGFuZGxpbmcgKEFkZXN0cmFyIEFuaW1haXMpJyxcbiAgICAnQXJjYW5hIChBcmNhbm8pJyxcbiAgICAnQXRobGV0aWNzIChBdGxldGlzbW8pJyxcbiAgICAnRGVjZXB0aW9uIChFbmdhbmHDp8OjbyknLFxuICAgICdIaXN0b3J5IChIaXN0w7NyaWEpJyxcbiAgICAnSW5zaWdodCAoSW50dWnDp8OjbyknLFxuICAgICdJbnRpbWlkYXRpb24gKEludGltaWRhw6fDo28pJyxcbiAgICAnSW52ZXN0aWdhdGlvbiAoSW52ZXN0aWdhw6fDo28pJyxcbiAgICAnTWVkaWNpbmUgKE1lZGljaW5hKScsXG4gICAgJ05hdHVyZSAoTmF0dXJlemEpJyxcbiAgICAnUGVyY2VwdGlvbiAoUGVyY2Vww6fDo28pJyxcbiAgICAnUGVyZm9ybWFuY2UgKEF0dWHDp8OjbyknLFxuICAgICdQZXJzdWFzaW9uIChQZXJzdWFzw6NvKScsXG4gICAgJ1JlbGlnaW9uIChSZWxpZ2nDo28pJyxcbiAgICAnU2xlaWdodCBvZiBIYW5kIChQcmVzdGlkaWdpdGHDp8OjbyknLFxuICAgICdTdGVhbHRoIChGdXJ0aXZpZGFkZSknLFxuICAgICdTdXJ2aXZhbCAoU29icmV2aXbDqm5jaWEpJyxcbiAgXSxcbiAgJ09yZGVtIFBhcmFub3JtYWwnOiBbXG4gICAgJ0Fjcm9iYWNpYScsXG4gICAgJ0FkZXN0cmFtZW50bycsXG4gICAgJ0FydGVzJyxcbiAgICAnQXRsZXRpc21vJyxcbiAgICAnQXR1YWxpZGFkZXMnLFxuICAgICdFbmdhbmHDp8OjbycsXG4gICAgJ0ZvcnRpdHVkZScsXG4gICAgJ0Z1cnRpdmlkYWRlJyxcbiAgICAnSW5pY2lhdGl2YScsXG4gICAgJ0ludGltaWRhw6fDo28nLFxuICAgICdJbnZlc3RpZ2HDp8OjbycsXG4gICAgJ0ludHVpw6fDo28nLFxuICAgICdMdXRhJyxcbiAgICAnTWVkaWNpbmEnLFxuICAgICdPY3VsdGlzbW8nLFxuICAgICdQZXJjZXDDp8OjbycsXG4gICAgJ1BlcnN1YXPDo28nLFxuICAgICdQaWxvdGFnZW0nLFxuICAgICdQb250YXJpYScsXG4gICAgJ1JlZmxleG9zJyxcbiAgICAnVGVjbm9sb2dpYScsXG4gICAgJ1ZvbnRhZGUnLFxuICBdLFxuICAnQ2FsbCBvZiBDdGh1bGh1JzogW1xuICAgICdBY2NvdW50aW5nIChDb250YWJpbGlkYWRlKScsXG4gICAgJ0FudGhyb3BvbG9neSAoQW50cm9wb2xvZ2lhKScsXG4gICAgJ0FyY2hhZW9sb2d5IChBcnF1ZW9sb2dpYSknLFxuICAgICdBcnQvQ3JhZnQgKEFydGUvT2bDrWNpbyknLFxuICAgICdDaGFybSAoTMOhYmlhKScsXG4gICAgJ0NsaW1iIChFc2NhbGFyKScsXG4gICAgJ0NyZWRpdCBSYXRpbmcgKENyw6lkaXRvKScsXG4gICAgJ0Rpc2d1aXNlIChEaXNmYXJjZSknLFxuICAgICdEb2RnZSAoRXNxdWl2YSknLFxuICAgICdEcml2ZSBBdXRvIChEaXJpZ2lyKScsXG4gICAgJ0Zhc3QgVGFsayAoTMOhYmlhIFLDoXBpZGEpJyxcbiAgICAnRmlyc3QgQWlkIChQcmltZWlyb3MgU29jb3Jyb3MpJyxcbiAgICAnSGlzdG9yeSAoSGlzdMOzcmlhKScsXG4gICAgJ0ludGltaWRhdGUgKEludGltaWRhw6fDo28pJyxcbiAgICAnSnVtcCAoU2FsdGFyKScsXG4gICAgJ0xhdyAoRGlyZWl0byknLFxuICAgICdMaWJyYXJ5IFVzZSAoQmlibGlvdGVjYSknLFxuICAgICdMaXN0ZW4gKEVzY3V0YXIpJyxcbiAgICAnTG9ja3NtaXRoIChBcnJvbWJhbWVudG8pJyxcbiAgICAnTWVkaWNpbmUgKE1lZGljaW5hKScsXG4gICAgJ05hdHVyYWwgV29ybGQgKE11bmRvIE5hdHVyYWwpJyxcbiAgICAnT2NjdWx0IChPY3VsdGlzbW8pJyxcbiAgICAnT3BlcmF0ZSBIZWF2eSBNYWNoaW5lcnkgKE3DoXF1aW5hcyBQZXNhZGFzKScsXG4gICAgJ1BlcnN1YWRlIChQZXJzdWFzw6NvKScsXG4gICAgJ1BzeWNob2xvZ3kgKFBzaWNvbG9naWEpJyxcbiAgICAnU2NpZW5jZSAoQ2nDqm5jaWEpJyxcbiAgICAnU3BvdCBIaWRkZW4gKE5vdGFyKScsXG4gICAgJ1N0ZWFsdGggKEZ1cnRpdmlkYWRlKScsXG4gICAgJ1N1cnZpdmFsIChTb2JyZXZpdsOqbmNpYSknLFxuICAgICdTd2ltIChOYXRhw6fDo28pJyxcbiAgICAnVGhyb3cgKEFycmVtZXNzbyknLFxuICAgICdUcmFjayAoUmFzdHJlYXIpJyxcbiAgXSxcbn07XG5cbmV4cG9ydCBjb25zdCBDTEFTU0VTX0JZX1NZU1RFTTogUmVjb3JkPFN1cHBvcnRlZFN5c3RlbSwgc3RyaW5nW10+ID0ge1xuICAnTmFycmF0aXZvJzogW1xuICAgICdBdmVudHVyZWlybycsXG4gICAgJ0V4cGxvcmFkb3InLFxuICAgICdTb2JyZXZpdmVudGUnLFxuICAgICdFcnVkaXRvJyxcbiAgICAnTWVyY2Vuw6FyaW8nLFxuICBdLFxuICAnRCZEIDVlJzogW1xuICAgICdCw6FyYmFybycsXG4gICAgJ0JhcmRvJyxcbiAgICAnQnJ1eG8nLFxuICAgICdDbMOpcmlnbycsXG4gICAgJ0RydWlkYScsXG4gICAgJ0ZlaXRpY2Vpcm8nLFxuICAgICdHdWVycmVpcm8nLFxuICAgICdMYWRpbm8nLFxuICAgICdNYWdvJyxcbiAgICAnTW9uZ2UnLFxuICAgICdQYWxhZGlubycsXG4gICAgJ1BhdHJ1bGhlaXJvJyxcbiAgICAnQXJ0w61maWNlJyxcbiAgXSxcbiAgJ09yZGVtIFBhcmFub3JtYWwnOiBbXG4gICAgJ0NvbWJhdGVudGUnLFxuICAgICdPY3VsdGlzdGEnLFxuICAgICdFc3BlY2lhbGlzdGEnLFxuICAgICdTb2JyZXZpdmVudGUnLFxuICBdLFxuICAnQ2FsbCBvZiBDdGh1bGh1JzogW1xuICAgICdJbnZlc3RpZ2Fkb3InLFxuICAgICdBbnRyb3DDs2xvZ28nLFxuICAgICdBcnF1ZcOzbG9nbycsXG4gICAgJ0FydGlzdGEnLFxuICAgICdEZXRldGl2ZScsXG4gICAgJ0pvcm5hbGlzdGEnLFxuICAgICdNw6lkaWNvJyxcbiAgICAnUHJvZmVzc29yJyxcbiAgICAnQ3JpbWlub3NvJyxcbiAgICAnRGlsZXRhbnRlJyxcbiAgICAnRW5nZW5oZWlybycsXG4gICAgJ0V4cGxvcmFkb3InLFxuICAgICdIaXN0b3JpYWRvcicsXG4gICAgJ0xpbmd1aXN0YScsXG4gICAgJ01pbGl0YXInLFxuICAgICdQb2xpY2lhbCcsXG4gICAgJ1BzaWPDs2xvZ28nLFxuICAgICdSZXDDs3J0ZXInLFxuICAgICdQZXNxdWlzYWRvcicsXG4gIF0sXG59O1xuXG5leHBvcnQgY29uc3QgSU5JVElBTF9TWVNURU1fUFJPTVBUX1RFTVBMQVRFID0gYFxuIyBQUk9UT0NPTE8gTUVTVFJFIFNVUFJFTU8gKHYyLjAgLSBTdHJpY3QgUnVsZXMpXG4jIyAxLiBQZXJzb25hIGUgTWlzc8Ojb1xuVm9jw6ogw6kgbyBNZXN0cmUgU3VwcmVtbyAoR2FtZSBNYXN0ZXIpLCBuYXJyYWRvciBleHBlcmllbnRlLlxuSWRpb21hOiBTRU1QUkUgUG9ydHVndcOqcyBkbyBCcmFzaWwuXG5PYmpldGl2bzogR3VpYXIgdW1hIGF2ZW50dXJhIGltZXJzaXZhIGNvbSBtZWPDom5pY2FzIHPDs2xpZGFzLlxuXG4jIyAyLiBDT05URVhUT1xuKipNdW5kbzoqKiB7e1dPUkxEX0hJU1RPUll9fVxuKipQZXJzb25hZ2VtOioqIHt7Q0hBUl9OQU1FfX0sIHt7Q0hBUl9BUFBFQVJBTkNFfX0uXG4qKkJhY2tncm91bmQ6Kioge3tDSEFSX0JBQ0tTVE9SWX19XG4qKlNpc3RlbWE6Kioge3tTWVNURU1fTkFNRX19XG4qKlJlZ3JhczoqKiB7e1NZU1RFTV9SVUxFU319XG5cbiMjIDMuIEdlc3TDo28gZGUgRXN0YWRvICYgUkVHUkFTIERFIERBRE9TIChDUsONVElDTylcbi0gKipSRUdSQSBERSBPVVJPIERBUyBST0xBR0VOUzoqKiBOw4NPIGFzc3VtYSBvIHN1Y2Vzc28gb3UgZnJhY2Fzc28gZGUgYcOnw7VlcyBpbmNlcnRhcy5cbi0gKipJTklDSUFUSVZBIFNFTSBST0xBR0VNOioqIEEgaW5pY2lhdGl2YSDDqSBzZW1wcmUgZGV0ZXJtaW5hZGEgcGVsbyBNQUlPUiBhdHJpYnV0byBkZSBkZXN0cmV6YSAob3UgZXF1aXZhbGVudGUgZG8gc2lzdGVtYSwgZXg6IGFnaWxpZGFkZS9yZWZsZXhvcykuIE7Do28gcGXDp2Egcm9sYWdlbSBwYXJhIGluaWNpYXRpdmEuXG4tIFNlIG8gam9nYWRvciBkaXNzZXIgXCJFdSB0ZW50byBvdXZpclwiLCBcIkV1IHByb2N1cm8gcG9yIGFybWFkaWxoYXNcIiwgXCJFdSBhdGFjb1wiLCBcIkV1IG1pbnRvXCIsIFwiRXUgZXNjYWxvXCI6XG4gIDEuICoqUEFSRSBBIE5BUlJBVElWQSBJTUVESUFUQU1FTlRFLioqXG4gIDIuIENoYW1lIGEgVG9vbCBcInJlcXVlc3Rfcm9sbFwiIGNvbSBvIGF0cmlidXRvIGFwcm9wcmlhZG8gKGV4OiBQZXJjZXB0aW9uLCBJbnZlc3RpZ2F0aW9uLCBBdGhsZXRpY3MpLlxuICAzLiBTw7MgY29udGludWUgYSBuYXJyYXRpdmEgYXDDs3MgcmVjZWJlciBvIHJlc3VsdGFkby5cbi0gVXNlIFRvb2wgXCJnZW5lcmF0ZV9pbWFnZVwiIEFQRU5BUyBlbTogSW7DrWNpbyBkYSBBdmVudHVyYSwgQm9zc2VzLCBMb2NhaXMgw4lwaWNvcy5cbi0gVXNlIFRvb2wgXCJ0cmlnZ2VyX2dhbWVfb3ZlclwiIHNlIFBWID0gMCBvdSBtb3J0ZSBuYXJyYXRpdmEgw7NidmlhLlxuXG4jIyA0LiBDb25zaXN0w6puY2lhIFZpc3VhbFxuRXN0aWxvOiBcInt7VklTVUFMX1NUWUxFfX1cIi4gVXNlIGVzdGUgZXN0aWxvIG5vcyBwcm9tcHRzIGRlIGltYWdlbS5cblxuIyMgNS4gRmx1eG8gZGUgVHVybm9cbjEuIFNlIGZvciB1bWEgcmVzcG9zdGEgYSB1bWEgcm9sYWdlbSwgbmFycmUgbyByZXN1bHRhZG8gKFN1Y2Vzc28gb3UgRmFsaGEpIGRyYW1hdGljYW1lbnRlLlxuMi4gTmFycmUgYSByZWHDp8OjbyBkbyBtdW5kby5cbjMuIE5vIGZpbmFsIGRlIENBREEgbWVuc2FnZW0sIGFkaWNpb25lIHVtYSBsaXN0YSBkZSAzIGEgNSBzdWdlc3TDtWVzLlxuICAgXG4gICBGb3JtYXRvIE9icmlnYXTDs3JpbyBkZSBTdWdlc3TDtWVzOlxuICAgIyMjIFN1Z2VzdMO1ZXM6XG4gICAtIEEpIFtBw6fDo28gU3VnZXJpZGEgMV1cbiAgIC0gQikgW0HDp8OjbyBTdWdlcmlkYSAyXVxuICAgLSBDKSBbQcOnw6NvIFN1Z2VyaWRhIDNdXG5cbiMjIDYuIEZvcm1hdGHDp8Ojb1xuLSBVc2UgTWFya2Rvd24gcmljby5cbi0gTmVncml0byBwYXJhIE5QQ3Mgb3UgSXRlbnMuXG4tICpJdMOhbGljbyogcGFyYSBzb25zIGUgcGVuc2FtZW50b3MuXG4tIFF1ZWJyYXMgZGUgbGluaGEgZHVwbGFzIHBhcmEgbGVnaWJpbGlkYWRlLlxuYDsiXSwibmFtZXMiOlsiUlBHX1NZU1RFTVMiLCJTVVBQT1JURURfU1lTVEVNUyIsIm5vcm1hbGl6ZVN5c3RlbU5hbWUiLCJzeXN0ZW1OYW1lIiwiaW5jbHVkZXMiLCJTS0lMTFNfQllfU1lTVEVNIiwiQ0xBU1NFU19CWV9TWVNURU0iLCJJTklUSUFMX1NZU1RFTV9QUk9NUFRfVEVNUExBVEUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./constants.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ai/keyPool.ts":
/*!***************************!*\
  !*** ./lib/ai/keyPool.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   pickApiKey: () => (/* binding */ pickApiKey)\n/* harmony export */ });\nfunction pickApiKey(userKey) {\n    if (userKey && userKey.trim().length > 0) return userKey.trim();\n    throw new Error(\"Missing BYOK header\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWkva2V5UG9vbC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQU8sU0FBU0EsV0FBV0MsT0FBZ0I7SUFDekMsSUFBSUEsV0FBV0EsUUFBUUMsSUFBSSxHQUFHQyxNQUFNLEdBQUcsR0FBRyxPQUFPRixRQUFRQyxJQUFJO0lBQzdELE1BQU0sSUFBSUUsTUFBTTtBQUNsQiIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RyYWktLS12aXJ0dWFsLXRhYmxldG9wLy4vbGliL2FpL2tleVBvb2wudHM/NjQ0MCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gcGlja0FwaUtleSh1c2VyS2V5Pzogc3RyaW5nKTogc3RyaW5nIHtcbiAgaWYgKHVzZXJLZXkgJiYgdXNlcktleS50cmltKCkubGVuZ3RoID4gMCkgcmV0dXJuIHVzZXJLZXkudHJpbSgpO1xuICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgQllPSyBoZWFkZXInKTtcbn1cbiJdLCJuYW1lcyI6WyJwaWNrQXBpS2V5IiwidXNlcktleSIsInRyaW0iLCJsZW5ndGgiLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/ai/keyPool.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ai/modelPool.ts":
/*!*****************************!*\
  !*** ./lib/ai/modelPool.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MODELS: () => (/* binding */ MODELS),\n/* harmony export */   withModelFallback: () => (/* binding */ withModelFallback)\n/* harmony export */ });\nconst MODELS = [\n    // TENTATIVA 1: O Melhor (Llama 3.3 70B)\n    \"llama-3.3-70b-versatile\",\n    // TENTATIVA 2: O Lógico (Qwen 2.5 72B) - Caso o Llama esteja com fila\n    \"qwen-2.5-72b-instruct\",\n    // TENTATIVA 3: O \"Tanque de Guerra\" (Llama 3.1 8B) - Caso você estoure o limite diário\n    \"llama-3.1-8b-instant\"\n];\nconst delay = (ms)=>new Promise((resolve)=>setTimeout(resolve, ms));\nconst modelIndexByKey = new Map();\nfunction clampIndex(index) {\n    if (index < 0) return 0;\n    if (index >= MODELS.length) return MODELS.length - 1;\n    return index;\n}\nasync function withModelFallback(handler, options) {\n    let lastError;\n    const wait = Math.max(0, options?.minDelayMs ?? 0);\n    const startIndex = options?.key ? clampIndex(modelIndexByKey.get(options.key) ?? 0) : 0;\n    for(let i = startIndex; i < MODELS.length; i += 1){\n        const model = MODELS[i];\n        try {\n            if (wait > 0 && i > startIndex) {\n                await delay(wait * (i - startIndex));\n            }\n            const result = await handler(model);\n            if (options?.key) {\n                modelIndexByKey.set(options.key, i);\n            }\n            return result;\n        } catch (error) {\n            const status = error?.status || error?.code;\n            if (status === 429) {\n                throw error;\n            }\n            lastError = error;\n        }\n    }\n    if (options?.key) {\n        modelIndexByKey.set(options.key, 0);\n    }\n    throw lastError ?? new Error(\"All models failed\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWkvbW9kZWxQb29sLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQU8sTUFBTUEsU0FBUztJQUNwQix3Q0FBd0M7SUFDeEM7SUFFQSxzRUFBc0U7SUFDdEU7SUFFQSx1RkFBdUY7SUFDdkY7Q0FDRCxDQUFDO0FBRUYsTUFBTUMsUUFBUSxDQUFDQyxLQUFlLElBQUlDLFFBQVEsQ0FBQ0MsVUFBWUMsV0FBV0QsU0FBU0Y7QUFFM0UsTUFBTUksa0JBQWtCLElBQUlDO0FBRTVCLFNBQVNDLFdBQVdDLEtBQWE7SUFDL0IsSUFBSUEsUUFBUSxHQUFHLE9BQU87SUFDdEIsSUFBSUEsU0FBU1QsT0FBT1UsTUFBTSxFQUFFLE9BQU9WLE9BQU9VLE1BQU0sR0FBRztJQUNuRCxPQUFPRDtBQUNUO0FBRU8sZUFBZUUsa0JBQ3BCQyxPQUFzQyxFQUN0Q0MsT0FBK0M7SUFFL0MsSUFBSUM7SUFDSixNQUFNQyxPQUFPQyxLQUFLQyxHQUFHLENBQUMsR0FBR0osU0FBU0ssY0FBYztJQUNoRCxNQUFNQyxhQUFhTixTQUFTTyxNQUN4QlosV0FBV0YsZ0JBQWdCZSxHQUFHLENBQUNSLFFBQVFPLEdBQUcsS0FBSyxLQUMvQztJQUVKLElBQUssSUFBSUUsSUFBSUgsWUFBWUcsSUFBSXRCLE9BQU9VLE1BQU0sRUFBRVksS0FBSyxFQUFHO1FBQ2xELE1BQU1DLFFBQVF2QixNQUFNLENBQUNzQixFQUFFO1FBQ3ZCLElBQUk7WUFDRixJQUFJUCxPQUFPLEtBQUtPLElBQUlILFlBQVk7Z0JBQzlCLE1BQU1sQixNQUFNYyxPQUFRTyxDQUFBQSxJQUFJSCxVQUFTO1lBQ25DO1lBQ0EsTUFBTUssU0FBUyxNQUFNWixRQUFRVztZQUM3QixJQUFJVixTQUFTTyxLQUFLO2dCQUNoQmQsZ0JBQWdCbUIsR0FBRyxDQUFDWixRQUFRTyxHQUFHLEVBQUVFO1lBQ25DO1lBQ0EsT0FBT0U7UUFDVCxFQUFFLE9BQU9FLE9BQU87WUFDZCxNQUFNQyxTQUFTLE9BQWdCQSxVQUFXRCxPQUFlRTtZQUN6RCxJQUFJRCxXQUFXLEtBQUs7Z0JBQ2xCLE1BQU1EO1lBQ1I7WUFDQVosWUFBWVk7UUFDZDtJQUNGO0lBRUEsSUFBSWIsU0FBU08sS0FBSztRQUNoQmQsZ0JBQWdCbUIsR0FBRyxDQUFDWixRQUFRTyxHQUFHLEVBQUU7SUFDbkM7SUFFQSxNQUFNTixhQUFhLElBQUllLE1BQU07QUFDL0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0cmFpLS0tdmlydHVhbC10YWJsZXRvcC8uL2xpYi9haS9tb2RlbFBvb2wudHM/MTZkNiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgTU9ERUxTID0gW1xuICAvLyBURU5UQVRJVkEgMTogTyBNZWxob3IgKExsYW1hIDMuMyA3MEIpXG4gICdsbGFtYS0zLjMtNzBiLXZlcnNhdGlsZScsXG5cbiAgLy8gVEVOVEFUSVZBIDI6IE8gTMOzZ2ljbyAoUXdlbiAyLjUgNzJCKSAtIENhc28gbyBMbGFtYSBlc3RlamEgY29tIGZpbGFcbiAgJ3F3ZW4tMi41LTcyYi1pbnN0cnVjdCcsXG5cbiAgLy8gVEVOVEFUSVZBIDM6IE8gXCJUYW5xdWUgZGUgR3VlcnJhXCIgKExsYW1hIDMuMSA4QikgLSBDYXNvIHZvY8OqIGVzdG91cmUgbyBsaW1pdGUgZGnDoXJpb1xuICAnbGxhbWEtMy4xLThiLWluc3RhbnQnLFxuXTtcblxuY29uc3QgZGVsYXkgPSAobXM6IG51bWJlcikgPT4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTtcblxuY29uc3QgbW9kZWxJbmRleEJ5S2V5ID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKTtcblxuZnVuY3Rpb24gY2xhbXBJbmRleChpbmRleDogbnVtYmVyKSB7XG4gIGlmIChpbmRleCA8IDApIHJldHVybiAwO1xuICBpZiAoaW5kZXggPj0gTU9ERUxTLmxlbmd0aCkgcmV0dXJuIE1PREVMUy5sZW5ndGggLSAxO1xuICByZXR1cm4gaW5kZXg7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3aXRoTW9kZWxGYWxsYmFjazxUPihcbiAgaGFuZGxlcjogKG1vZGVsOiBzdHJpbmcpID0+IFByb21pc2U8VD4sXG4gIG9wdGlvbnM/OiB7IG1pbkRlbGF5TXM/OiBudW1iZXI7IGtleT86IHN0cmluZyB9XG4pOiBQcm9taXNlPFQ+IHtcbiAgbGV0IGxhc3RFcnJvcjogdW5rbm93bjtcbiAgY29uc3Qgd2FpdCA9IE1hdGgubWF4KDAsIG9wdGlvbnM/Lm1pbkRlbGF5TXMgPz8gMCk7XG4gIGNvbnN0IHN0YXJ0SW5kZXggPSBvcHRpb25zPy5rZXlcbiAgICA/IGNsYW1wSW5kZXgobW9kZWxJbmRleEJ5S2V5LmdldChvcHRpb25zLmtleSkgPz8gMClcbiAgICA6IDA7XG5cbiAgZm9yIChsZXQgaSA9IHN0YXJ0SW5kZXg7IGkgPCBNT0RFTFMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBjb25zdCBtb2RlbCA9IE1PREVMU1tpXTtcbiAgICB0cnkge1xuICAgICAgaWYgKHdhaXQgPiAwICYmIGkgPiBzdGFydEluZGV4KSB7XG4gICAgICAgIGF3YWl0IGRlbGF5KHdhaXQgKiAoaSAtIHN0YXJ0SW5kZXgpKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIobW9kZWwpO1xuICAgICAgaWYgKG9wdGlvbnM/LmtleSkge1xuICAgICAgICBtb2RlbEluZGV4QnlLZXkuc2V0KG9wdGlvbnMua2V5LCBpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IHN0YXR1cyA9IChlcnJvciBhcyBhbnkpPy5zdGF0dXMgfHwgKGVycm9yIGFzIGFueSk/LmNvZGU7XG4gICAgICBpZiAoc3RhdHVzID09PSA0MjkpIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgICBsYXN0RXJyb3IgPSBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBpZiAob3B0aW9ucz8ua2V5KSB7XG4gICAgbW9kZWxJbmRleEJ5S2V5LnNldChvcHRpb25zLmtleSwgMCk7XG4gIH1cblxuICB0aHJvdyBsYXN0RXJyb3IgPz8gbmV3IEVycm9yKCdBbGwgbW9kZWxzIGZhaWxlZCcpO1xufVxuIl0sIm5hbWVzIjpbIk1PREVMUyIsImRlbGF5IiwibXMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJtb2RlbEluZGV4QnlLZXkiLCJNYXAiLCJjbGFtcEluZGV4IiwiaW5kZXgiLCJsZW5ndGgiLCJ3aXRoTW9kZWxGYWxsYmFjayIsImhhbmRsZXIiLCJvcHRpb25zIiwibGFzdEVycm9yIiwid2FpdCIsIk1hdGgiLCJtYXgiLCJtaW5EZWxheU1zIiwic3RhcnRJbmRleCIsImtleSIsImdldCIsImkiLCJtb2RlbCIsInJlc3VsdCIsInNldCIsImVycm9yIiwic3RhdHVzIiwiY29kZSIsIkVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/ai/modelPool.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ai/rateLimit.ts":
/*!*****************************!*\
  !*** ./lib/ai/rateLimit.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isRateLimited: () => (/* binding */ isRateLimited)\n/* harmony export */ });\n/* harmony import */ var _supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n\nconst RATE_LIMIT_WINDOW_MS = 60000;\nconst RATE_LIMIT_WINDOW_SEC = 60;\nconst RATE_LIMIT_MAX = 20;\nconst rateLimitStore = new Map();\nfunction isRateLimitedInMemory(key) {\n    const now = Date.now();\n    const windowStart = now - RATE_LIMIT_WINDOW_MS;\n    const timestamps = rateLimitStore.get(key)?.filter((t)=>t >= windowStart) || [];\n    if (timestamps.length >= RATE_LIMIT_MAX) {\n        rateLimitStore.set(key, timestamps);\n        return true;\n    }\n    timestamps.push(now);\n    rateLimitStore.set(key, timestamps);\n    return false;\n}\nasync function isRateLimited(key) {\n    const admin = (0,_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createAdminClient)();\n    if (!admin) {\n        return isRateLimitedInMemory(key);\n    }\n    const { data, error } = await admin.rpc(\"check_rate_limit\", {\n        p_key: key,\n        p_limit: RATE_LIMIT_MAX,\n        p_window_seconds: RATE_LIMIT_WINDOW_SEC\n    });\n    if (error) {\n        return isRateLimitedInMemory(key);\n    }\n    return Boolean(data);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYWkvcmF0ZUxpbWl0LnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXVEO0FBRXZELE1BQU1DLHVCQUF1QjtBQUM3QixNQUFNQyx3QkFBd0I7QUFDOUIsTUFBTUMsaUJBQWlCO0FBQ3ZCLE1BQU1DLGlCQUFpQixJQUFJQztBQUUzQixTQUFTQyxzQkFBc0JDLEdBQVc7SUFDeEMsTUFBTUMsTUFBTUMsS0FBS0QsR0FBRztJQUNwQixNQUFNRSxjQUFjRixNQUFNUDtJQUMxQixNQUFNVSxhQUFhUCxlQUFlUSxHQUFHLENBQUNMLE1BQU1NLE9BQU8sQ0FBQ0MsSUFBTUEsS0FBS0osZ0JBQWdCLEVBQUU7SUFFakYsSUFBSUMsV0FBV0ksTUFBTSxJQUFJWixnQkFBZ0I7UUFDdkNDLGVBQWVZLEdBQUcsQ0FBQ1QsS0FBS0k7UUFDeEIsT0FBTztJQUNUO0lBRUFBLFdBQVdNLElBQUksQ0FBQ1Q7SUFDaEJKLGVBQWVZLEdBQUcsQ0FBQ1QsS0FBS0k7SUFDeEIsT0FBTztBQUNUO0FBRU8sZUFBZU8sY0FBY1gsR0FBVztJQUM3QyxNQUFNWSxRQUFRbkIsbUVBQWlCQTtJQUMvQixJQUFJLENBQUNtQixPQUFPO1FBQ1YsT0FBT2Isc0JBQXNCQztJQUMvQjtJQUVBLE1BQU0sRUFBRWEsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNRixNQUFNRyxHQUFHLENBQUMsb0JBQW9CO1FBQzFEQyxPQUFPaEI7UUFDUGlCLFNBQVNyQjtRQUNUc0Isa0JBQWtCdkI7SUFDcEI7SUFFQSxJQUFJbUIsT0FBTztRQUNULE9BQU9mLHNCQUFzQkM7SUFDL0I7SUFFQSxPQUFPbUIsUUFBUU47QUFDakIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0cmFpLS0tdmlydHVhbC10YWJsZXRvcC8uL2xpYi9haS9yYXRlTGltaXQudHM/YmI2ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVBZG1pbkNsaWVudCB9IGZyb20gJy4uL3N1cGFiYXNlL3NlcnZlcic7XG5cbmNvbnN0IFJBVEVfTElNSVRfV0lORE9XX01TID0gNjBfMDAwO1xuY29uc3QgUkFURV9MSU1JVF9XSU5ET1dfU0VDID0gNjA7XG5jb25zdCBSQVRFX0xJTUlUX01BWCA9IDIwO1xuY29uc3QgcmF0ZUxpbWl0U3RvcmUgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyW10+KCk7XG5cbmZ1bmN0aW9uIGlzUmF0ZUxpbWl0ZWRJbk1lbW9yeShrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICBjb25zdCB3aW5kb3dTdGFydCA9IG5vdyAtIFJBVEVfTElNSVRfV0lORE9XX01TO1xuICBjb25zdCB0aW1lc3RhbXBzID0gcmF0ZUxpbWl0U3RvcmUuZ2V0KGtleSk/LmZpbHRlcigodCkgPT4gdCA+PSB3aW5kb3dTdGFydCkgfHwgW107XG5cbiAgaWYgKHRpbWVzdGFtcHMubGVuZ3RoID49IFJBVEVfTElNSVRfTUFYKSB7XG4gICAgcmF0ZUxpbWl0U3RvcmUuc2V0KGtleSwgdGltZXN0YW1wcyk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICB0aW1lc3RhbXBzLnB1c2gobm93KTtcbiAgcmF0ZUxpbWl0U3RvcmUuc2V0KGtleSwgdGltZXN0YW1wcyk7XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzUmF0ZUxpbWl0ZWQoa2V5OiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgYWRtaW4gPSBjcmVhdGVBZG1pbkNsaWVudCgpO1xuICBpZiAoIWFkbWluKSB7XG4gICAgcmV0dXJuIGlzUmF0ZUxpbWl0ZWRJbk1lbW9yeShrZXkpO1xuICB9XG5cbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYWRtaW4ucnBjKCdjaGVja19yYXRlX2xpbWl0Jywge1xuICAgIHBfa2V5OiBrZXksXG4gICAgcF9saW1pdDogUkFURV9MSU1JVF9NQVgsXG4gICAgcF93aW5kb3dfc2Vjb25kczogUkFURV9MSU1JVF9XSU5ET1dfU0VDLFxuICB9KTtcblxuICBpZiAoZXJyb3IpIHtcbiAgICByZXR1cm4gaXNSYXRlTGltaXRlZEluTWVtb3J5KGtleSk7XG4gIH1cblxuICByZXR1cm4gQm9vbGVhbihkYXRhKTtcbn0iXSwibmFtZXMiOlsiY3JlYXRlQWRtaW5DbGllbnQiLCJSQVRFX0xJTUlUX1dJTkRPV19NUyIsIlJBVEVfTElNSVRfV0lORE9XX1NFQyIsIlJBVEVfTElNSVRfTUFYIiwicmF0ZUxpbWl0U3RvcmUiLCJNYXAiLCJpc1JhdGVMaW1pdGVkSW5NZW1vcnkiLCJrZXkiLCJub3ciLCJEYXRlIiwid2luZG93U3RhcnQiLCJ0aW1lc3RhbXBzIiwiZ2V0IiwiZmlsdGVyIiwidCIsImxlbmd0aCIsInNldCIsInB1c2giLCJpc1JhdGVMaW1pdGVkIiwiYWRtaW4iLCJkYXRhIiwiZXJyb3IiLCJycGMiLCJwX2tleSIsInBfbGltaXQiLCJwX3dpbmRvd19zZWNvbmRzIiwiQm9vbGVhbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/ai/rateLimit.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase/server.ts":
/*!********************************!*\
  !*** ./lib/supabase/server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAdminClient: () => (/* binding */ createAdminClient),\n/* harmony export */   createServerClient: () => (/* binding */ createServerClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\nconst SUPABASE_URL = \"https://uhfqpdcylnhqmbhqzfqp.supabase.co\";\nconst SUPABASE_ANON_KEY = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVoZnFwZGN5bG5ocW1iaHF6ZnFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwNTg0OTcsImV4cCI6MjA4NTYzNDQ5N30.bsnJbhS4hS8JNxU4JIyIX4AWpm-rrmmK2KAWaPgGzm0\";\nconst SUPABASE_SERVICE_ROLE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY;\nif (!SUPABASE_URL || !SUPABASE_ANON_KEY) {\n    throw new Error(\"Missing Supabase env vars\");\n}\nfunction createServerClient(accessToken) {\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(SUPABASE_URL, SUPABASE_ANON_KEY, {\n        global: {\n            headers: accessToken ? {\n                Authorization: `Bearer ${accessToken}`\n            } : {}\n        }\n    });\n}\nfunction createAdminClient() {\n    if (!SUPABASE_SERVICE_ROLE_KEY) return null;\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY, {\n        auth: {\n            persistSession: false\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Uvc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFxRDtBQUVyRCxNQUFNQyxlQUFlQywwQ0FBb0M7QUFDekQsTUFBTUcsb0JBQW9CSCxrTkFBeUM7QUFDbkUsTUFBTUssNEJBQTRCTCxRQUFRQyxHQUFHLENBQUNJLHlCQUF5QjtBQUV2RSxJQUFJLENBQUNOLGdCQUFnQixDQUFDSSxtQkFBbUI7SUFDdkMsTUFBTSxJQUFJRyxNQUFNO0FBQ2xCO0FBRU8sU0FBU0MsbUJBQW1CQyxXQUFvQjtJQUNyRCxPQUFPVixtRUFBWUEsQ0FBQ0MsY0FBY0ksbUJBQW1CO1FBQ25ETSxRQUFRO1lBQ05DLFNBQVNGLGNBQWM7Z0JBQUVHLGVBQWUsQ0FBQyxPQUFPLEVBQUVILFlBQVksQ0FBQztZQUFDLElBQUksQ0FBQztRQUN2RTtJQUNGO0FBQ0Y7QUFFTyxTQUFTSTtJQUNkLElBQUksQ0FBQ1AsMkJBQTJCLE9BQU87SUFDdkMsT0FBT1AsbUVBQVlBLENBQUNDLGNBQWNNLDJCQUEyQjtRQUMzRFEsTUFBTTtZQUFFQyxnQkFBZ0I7UUFBTTtJQUNoQztBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdHJhaS0tLXZpcnR1YWwtdGFibGV0b3AvLi9saWIvc3VwYWJhc2Uvc2VydmVyLnRzPzY2MjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcblxuY29uc3QgU1VQQUJBU0VfVVJMID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIGFzIHN0cmluZztcbmNvbnN0IFNVUEFCQVNFX0FOT05fS0VZID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgYXMgc3RyaW5nO1xuY29uc3QgU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkgYXMgc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG5pZiAoIVNVUEFCQVNFX1VSTCB8fCAhU1VQQUJBU0VfQU5PTl9LRVkpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIFN1cGFiYXNlIGVudiB2YXJzJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTZXJ2ZXJDbGllbnQoYWNjZXNzVG9rZW4/OiBzdHJpbmcpIHtcbiAgcmV0dXJuIGNyZWF0ZUNsaWVudChTVVBBQkFTRV9VUkwsIFNVUEFCQVNFX0FOT05fS0VZLCB7XG4gICAgZ2xvYmFsOiB7XG4gICAgICBoZWFkZXJzOiBhY2Nlc3NUb2tlbiA/IHsgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2FjY2Vzc1Rva2VufWAgfSA6IHt9LFxuICAgIH0sXG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQWRtaW5DbGllbnQoKSB7XG4gIGlmICghU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSkgcmV0dXJuIG51bGw7XG4gIHJldHVybiBjcmVhdGVDbGllbnQoU1VQQUJBU0VfVVJMLCBTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZLCB7XG4gICAgYXV0aDogeyBwZXJzaXN0U2Vzc2lvbjogZmFsc2UgfSxcbiAgfSk7XG59Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsIlNVUEFCQVNFX1VSTCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9BTk9OX0tFWSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsIkVycm9yIiwiY3JlYXRlU2VydmVyQ2xpZW50IiwiYWNjZXNzVG9rZW4iLCJnbG9iYWwiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImNyZWF0ZUFkbWluQ2xpZW50IiwiYXV0aCIsInBlcnNpc3RTZXNzaW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase/server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/formdata-node","vendor-chunks/ms","vendor-chunks/zod","vendor-chunks/groq-sdk","vendor-chunks/event-target-shim","vendor-chunks/agentkeepalive","vendor-chunks/form-data-encoder","vendor-chunks/abort-controller","vendor-chunks/humanize-ms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcharacter-infer%2Froute&page=%2Fapi%2Fcharacter-infer%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcharacter-infer%2Froute.ts&appDir=%2Fhome%2Fjr%2FProjetos%2FMestrAi%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fjr%2FProjetos%2FMestrAi&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();